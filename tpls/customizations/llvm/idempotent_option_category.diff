diff --git a/llvm/lib/Support/CommandLine.cpp b/llvm/lib/Support/CommandLine.cpp
--- a/llvm/lib/Support/CommandLine.cpp
+++ b/llvm/lib/Support/CommandLine.cpp
@@ -354,13 +354,14 @@ public:
   void printOptionValues();

   void registerCategory(OptionCategory *cat) {
-    assert(count_if(RegisteredOptionCategories,
-                    [cat](const OptionCategory *Category) {
-             return cat->getName() == Category->getName();
-           }) == 0 &&
-           "Duplicate option categories");
-
-    RegisteredOptionCategories.insert(cat);
+    // Allow idempotent registration - if a category with this name already
+    // exists, skip registration. This supports scenarios where multiple
+    // libraries may each have their own copy of LLVM globals.
+    if (count_if(RegisteredOptionCategories,
+                 [cat](const OptionCategory *Category) {
+           return cat->getName() == Category->getName();
+         }) == 0)
+      RegisteredOptionCategories.insert(cat);
   }

   void registerSubCommand(SubCommand *sub) {
