<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dynamics Simulation &mdash; NVIDIA CUDA-Q  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/cudaq_override.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/_static/cudaq_override.css" type="text/css" />
      <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/tabs.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../_static/filter.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CUDA-QX" href="cudaqx/cudaqx.html" />
    <link rel="prev" title="NVIDIA Quantum Cloud" href="backends/cloud/nvqc.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #76b900" > 

          
          
          <a href="../index.html" class="icon icon-home">
            NVIDIA CUDA-Q
          </a>
              <div class="version">
                pr-3535
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #76b900;
    }

    .wy-side-nav-search a:link, .wy-nav-top a:link {
      color: #fff;
    }
    .wy-side-nav-search a:visited, .wy-nav-top a:visited {
      color: #fff;
    }
    .wy-side-nav-search a:hover, .wy-nav-top a:hover {
      color: #fff;
    }

    .wy-menu-vertical a:link, .wy-menu-vertical a:visited {
      color: #d9d9d9
    }

    .wy-menu-vertical a:active {
      background-color: #76b900
    }

    .wy-side-nav-search>div.version {
      color: rgba(0, 0, 0, 0.3)
    }

    /* override table width restrictions */
    .wy-table-responsive table td, .wy-table-responsive table th {
        white-space: normal;
    }

    .wy-table-responsive {
        margin-bottom: 24px;
        max-width: 100%;
        overflow: visible;
    }
  </style>
  
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">   Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#install-cuda-q">Install CUDA-Q</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#validate-your-installation">Validate your Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#cuda-q-academic">CUDA-Q Academic</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="basics/basics.html">   Basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="basics/kernel_intro.html">   What is a CUDA-Q Kernel?</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics/build_kernel.html">   Building your first CUDA-Q Program</a></li>
<li class="toctree-l2"><a class="reference internal" href="basics/run_kernel.html">   Running your first CUDA-Q Program</a><ul>
<li class="toctree-l3"><a class="reference internal" href="basics/run_kernel.html#sample">Sample</a></li>
<li class="toctree-l3"><a class="reference internal" href="basics/run_kernel.html#run">Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="basics/run_kernel.html#observe">Observe</a></li>
<li class="toctree-l3"><a class="reference internal" href="basics/run_kernel.html#running-on-a-gpu">Running on a GPU</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="basics/troubleshooting.html">   Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="basics/troubleshooting.html#debugging-and-verbose-simulation-output">Debugging and Verbose Simulation Output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/examples.html">   Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/introduction.html">   Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/building_kernels.html">   Building Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/building_kernels.html#defining-kernels">Defining Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/building_kernels.html#initializing-states">Initializing states</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/building_kernels.html#applying-gates">Applying Gates</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/building_kernels.html#controlled-operations">Controlled Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/building_kernels.html#multi-controlled-operations">Multi-Controlled Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/building_kernels.html#adjoint-operations">Adjoint Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/building_kernels.html#custom-operations">Custom Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/building_kernels.html#building-kernels-with-kernels">Building Kernels with Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/building_kernels.html#parameterized-kernels">Parameterized Kernels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/quantum_operations.html">   Quantum Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/quantum_operations.html#quantum-states">Quantum States</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/quantum_operations.html#quantum-gates">Quantum Gates</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/quantum_operations.html#measurements">Measurements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/measuring_kernels.html">   Measuring Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/measuring_kernels.html#mid-circuit-measurement-and-conditional-logic">Mid-circuit Measurement and Conditional Logic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/python/visualization.html">   Visualizing Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/visualization.html#Qubit-Visualization">Qubit Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/visualization.html#Kernel-Visualization">Kernel Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/executing_kernels.html">   Executing Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/executing_kernels.html#sample">Sample</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/executing_kernels.html#sample-asynchronous">Sample Asynchronous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/executing_kernels.html#run">Run</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/executing_kernels.html#return-custom-data-types">Return Custom Data Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/executing_kernels.html#run-asynchronous">Run Asynchronous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/executing_kernels.html#observe">Observe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/executing_kernels.html#observe-asynchronous">Observe Asynchronous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/executing_kernels.html#get-state">Get State</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/executing_kernels.html#get-state-asynchronous">Get State Asynchronous</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/expectation_values.html">   Computing Expectation Values</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/expectation_values.html#parallelizing-across-multiple-processors">Parallelizing across Multiple Processors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/multi_gpu_workflows.html">   Multi-GPU Workflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/multi_gpu_workflows.html#from-cpu-to-gpu">From CPU to GPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/multi_gpu_workflows.html#pooling-the-memory-of-multiple-gpus-mgpu">Pooling the memory of multiple GPUs (<code class="code docutils literal notranslate"><span class="pre">mgpu</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/multi_gpu_workflows.html#parallel-execution-over-multiple-qpus-mqpu">Parallel execution over multiple QPUs (<code class="code docutils literal notranslate"><span class="pre">mqpu</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="examples/multi_gpu_workflows.html#batching-hamiltonian-terms">Batching Hamiltonian Terms</a></li>
<li class="toctree-l4"><a class="reference internal" href="examples/multi_gpu_workflows.html#circuit-batching">Circuit Batching</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="examples/multi_gpu_workflows.html#multi-qpu-other-backends-remote-mqpu">Multi-QPU + Other Backends (<code class="code docutils literal notranslate"><span class="pre">remote-mqpu</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/python/optimizers_gradients.html">   Optimizers &amp; Gradients</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/optimizers_gradients.html#Built-in-CUDA-Q-Optimizers-and-Gradients">Built in CUDA-Q Optimizers and Gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/optimizers_gradients.html#Third-Party-Optimizers">Third-Party Optimizers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/optimizers_gradients.html#Parallel-Parameter-Shift-Gradients">Parallel Parameter Shift Gradients</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/python/noisy_simulations.html">   Noisy Simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/operators.html">   Constructing Operators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/operators.html#constructing-spin-operators">Constructing Spin Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/operators.html#pauli-words-and-exponentiating-pauli-words">Pauli Words and Exponentiating Pauli Words</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../examples/python/performance_optimizations.html">   Performance Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/performance_optimizations.html#Gate-Fusion">Gate Fusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/hardware_providers.html">   Using Quantum Hardware Providers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#amazon-braket">Amazon Braket</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#anyon-technologies">Anyon Technologies</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#infleqtion">Infleqtion</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#ionq">IonQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#iqm">IQM</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#oqc">OQC</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#orca-computing">ORCA Computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#pasqal">Pasqal</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#quantinuum">Quantinuum</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#quantum-circuits-inc">Quantum Circuits, Inc.</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#quantum-machines">Quantum Machines</a></li>
<li class="toctree-l3"><a class="reference internal" href="examples/hardware_providers.html#quera-computing">QuEra Computing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="examples/dynamics_examples.html">   Dynamics Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_1.html">   Introduction to CUDA-Q Dynamics (Jaynes-Cummings Model)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_1.html#Why-dynamics-simulations-vs.-circuit-simulations?">Why dynamics simulations vs. circuit simulations?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_1.html#Functionality">Functionality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_1.html#Performance">Performance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_1.html#Section-1---Simulating-the-Jaynes-Cummings-Hamiltonian">Section 1 - Simulating the Jaynes-Cummings Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_1.html#Exercise-1---Simulating-a-many-photon-Jaynes-Cummings-Hamiltonian">Exercise 1 - Simulating a many-photon Jaynes-Cummings Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_1.html#Section-2---Simulating-open-quantum-systems-with-the-collapse_operators">Section 2 - Simulating open quantum systems with the <code class="docutils literal notranslate"><span class="pre">collapse_operators</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_1.html#Exercise-2---Adding-additional-jump-operators-L_i">Exercise 2 - Adding additional jump operators <span class="math notranslate nohighlight">\(L_i\)</span></a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_1.html#Section-3---Many-qubits-coupled-to-the-resonator">Section 3 - Many qubits coupled to the resonator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_2.html">   Introduction to CUDA-Q Dynamics (Time Dependent Hamiltonians)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_2.html#The-Landau-Zener-model">The Landau-Zener model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_2.html#Section-1---Implementing-time-dependent-terms">Section 1 - Implementing time dependent terms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_2.html#Section-2---Implementing-custom-operators">Section 2 - Implementing custom operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_2.html#Section-3---Heisenberg-Model-with-a-time-varying-magnetic-field">Section 3 - Heisenberg Model with a time-varying magnetic field</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_2.html#Exercise-1---Define-a-time-varying-magnetic-field">Exercise 1 - Define a time-varying magnetic field</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/dynamics_intro_2.html#Exercise-2-(Optional)">Exercise 2 (Optional)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/dynamics/superconducting.html">   Superconducting Qubits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/superconducting.html#Cavity-QED">Cavity QED</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/superconducting.html#Cross-Resonance">Cross Resonance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/superconducting.html#Transmon-Resonator">Transmon Resonator</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/dynamics/spinqubits.html">   Spin Qubits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/spinqubits.html#Silicon-Spin-Qubit">Silicon Spin Qubit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/spinqubits.html#Heisenberg-Model">Heisenberg Model</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/dynamics/iontrap.html">   Trapped Ion Qubits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/iontrap.html#GHZ-state">GHZ state</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../examples/python/dynamics/control.html">   Control</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/control.html#Gate-Calibration">Gate Calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/control.html#Pulse">Pulse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/control.html#Qubit-Control">Qubit Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/control.html#Qubit-Dynamics">Qubit Dynamics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../examples/python/dynamics/control.html#Landau-Zenner">Landau-Zenner</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="applications.html">   Applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/qaoa.html">Max-Cut with QAOA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/digitized_counterdiabatic_qaoa.html">Molecular docking via DC-QAOA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/digitized_counterdiabatic_qaoa.html#Setting-up-the-Molecular-Docking-Problem">Setting up the Molecular Docking Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/digitized_counterdiabatic_qaoa.html#CUDA-Q-Implementation">CUDA-Q Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/krylov.html">Multi-reference Quantum Krylov Algorithm - <span class="math notranslate nohighlight">\(H_2\)</span> Molecule</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/krylov.html#Setup">Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/krylov.html#Computing-the-matrix-elements">Computing the matrix elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/krylov.html#Determining-the-ground-state-energy-of-the-subspace">Determining the ground state energy of the subspace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/qsci.html">Quantum-Selected Configuration Interaction (QSCI)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/qsci.html#0.-Problem-definition">0. Problem definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/qsci.html#1.-Prepare-an-Approximate-Quantum-State">1. Prepare an Approximate Quantum State</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/qsci.html#2-Quantum-Sampling-to-Select-Configuration">2 Quantum Sampling to Select Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/qsci.html#3.-Classical-Diagonalization-on-the-Selected-Subspace">3. Classical Diagonalization on the Selected Subspace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/qsci.html#5.-Compuare-results">5. Compuare results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/qsci.html#Reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/bernstein_vazirani.html">Bernstein-Vazirani Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/bernstein_vazirani.html#Classical-case">Classical case</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/bernstein_vazirani.html#Quantum-case">Quantum case</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/bernstein_vazirani.html#Implementing-in-CUDA-Q">Implementing in CUDA-Q</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/cost_minimization.html">Cost Minimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/deutsch_algorithm.html">Deutsch’s Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/deutsch_algorithm.html#XOR-\oplus">XOR <span class="math notranslate nohighlight">\(\oplus\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/deutsch_algorithm.html#Quantum-oracles">Quantum oracles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/deutsch_algorithm.html#Phase-oracle">Phase oracle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/deutsch_algorithm.html#Quantum-parallelism">Quantum parallelism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/deutsch_algorithm.html#Deutsch's-Algorithm:">Deutsch’s Algorithm:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/divisive_clustering_coresets.html">Divisive Clustering With Coresets Using CUDA-Q</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/divisive_clustering_coresets.html#Data-preprocessing">Data preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/divisive_clustering_coresets.html#Quantum-functions">Quantum functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/divisive_clustering_coresets.html#Divisive-Clustering-Function">Divisive Clustering Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/divisive_clustering_coresets.html#QAOA-Implementation">QAOA Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/divisive_clustering_coresets.html#Scaling-simulations-with-CUDA-Q">Scaling simulations with CUDA-Q</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/hybrid_quantum_neural_networks.html">Hybrid Quantum Neural Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/hadamard_test.html">Using the Hadamard Test to Determine Quantum Krylov Subspace Decomposition Matrix Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hadamard_test.html#Numerical-result-as-a-reference:">Numerical result as a reference:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hadamard_test.html#Using-Sample-to-perform-the-Hadamard-test">Using <code class="docutils literal notranslate"><span class="pre">Sample</span></code> to perform the Hadamard test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hadamard_test.html#Multi-GPU-evaluation-of-QKSD-matrix-elements-using-the-Hadamard-Test">Multi-GPU evaluation of QKSD matrix elements using the Hadamard Test</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/hadamard_test.html#Classically-Diagonalize-the-Subspace-Matrix">Classically Diagonalize the Subspace Matrix</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/logical_aim_sqale.html">Anderson Impurity Model ground state solver on Infleqtion’s Sqale</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/logical_aim_sqale.html#Performing-logical-Variational-Quantum-Eigensolver-(VQE)-with-CUDA-QX">Performing logical Variational Quantum Eigensolver (VQE) with CUDA-QX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/logical_aim_sqale.html#Constructing-circuits-in-the-[[4,2,2]]-encoding">Constructing circuits in the <code class="docutils literal notranslate"><span class="pre">[[4,2,2]]</span></code> encoding</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/logical_aim_sqale.html#Setting-up-submission-and-decoding-workflow">Setting up submission and decoding workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/logical_aim_sqale.html#Running-a-CUDA-Q-noisy-simulation">Running a CUDA-Q noisy simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/logical_aim_sqale.html#Running-logical-AIM-on-Infleqtion's-hardware">Running logical AIM on Infleqtion’s hardware</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html">Spin-Hamiltonian Simulation Using CUDA-Q</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Introduction">Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Heisenberg-Hamiltonian">Heisenberg Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Transverse-Field-Ising-Model-(TFIM)">Transverse Field Ising Model (TFIM)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Time-Evolution-and-Trotter-Decomposition">Time Evolution and Trotter Decomposition</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Key-steps">Key steps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#1.-Prepare-initial-state">1. Prepare initial state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#2.-Hamiltonian-Trotterization">2. Hamiltonian Trotterization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#3.-Compute-overlap">3. <code class="docutils literal notranslate"><span class="pre">Compute</span> <span class="pre">overlap</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#4.-Construct-Heisenberg-Hamiltonian">4. Construct Heisenberg Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#5.-Construct-TFIM-Hamiltonian">5. Construct TFIM Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#6.-Extract-coefficients-and-Pauli-words">6. Extract coefficients and Pauli words</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Main-code">Main code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Visualization-of-probablity-over-time">Visualization of probablity over time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Expectation-value-over-time:">Expectation value over time:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Visualization-of-expectation-over-time">Visualization of expectation over time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Additional-information">Additional information</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/hamiltonian_simulation.html#Relevant-references">Relevant references</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/quantum_fourier_transform.html">Quantum Fourier Transform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/quantum_fourier_transform.html#Quantum-Fourier-Transform-revisited">Quantum Fourier Transform revisited</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/quantum_teleportation.html">Quantum Teleporation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/quantum_teleportation.html#Teleportation-explained">Teleportation explained</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/quantum_volume.html">Quantum Volume</a></li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/readout_error_mitigation.html">Readout Error Mitigation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/readout_error_mitigation.html#Inverse-confusion-matrix-from-single-qubit-noise-model">Inverse confusion matrix from single-qubit noise model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/readout_error_mitigation.html#Inverse-confusion-matrix-from-k-local-confusion-matrices">Inverse confusion matrix from k local confusion matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/readout_error_mitigation.html#Inverse-of-full-confusion-matrix">Inverse of full confusion matrix</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html">Compiling Unitaries Using Diffusion Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Diffusion-model-pipeline">Diffusion model pipeline</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Setup-and-load-models">Setup and load models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Load-discrete-model">Load discrete model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Load-continuous-model">Load continuous model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Create-helper-functions">Create helper functions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Unitary-compilation">Unitary compilation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Random-unitary">Random unitary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Discrete-model">Discrete model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Continuous-model">Continuous model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Quantum-Fourier-transform">Quantum Fourier transform</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#XXZ-Hamiltonian-evolution">XXZ-Hamiltonian evolution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/unitary_compilation_diffusion_models.html#Choosing-the-circuit-you-need">Choosing the circuit you need</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/vqe_advanced.html">VQE with gradients, active spaces, and gate fusion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/vqe_advanced.html#The-Basics-of-VQE">The Basics of VQE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/vqe_advanced.html#Installing/Loading-Relevant-Packages">Installing/Loading Relevant Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/vqe_advanced.html#Implementing-VQE-in-CUDA-Q">Implementing VQE in CUDA-Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/vqe_advanced.html#Parallel-Parameter-Shift-Gradients">Parallel Parameter Shift Gradients</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/vqe_advanced.html#Using-an-Active-Space">Using an Active Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/vqe_advanced.html#Gate-Fusion-for-Larger-Circuits">Gate Fusion for Larger Circuits</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/quantum_transformer.html">Quantum Transformer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/quantum_transformer.html#Installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/quantum_transformer.html#Algorithm-and-Example">Algorithm and Example</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/quantum_transformer.html#Creating-the-self-attention-circuits">Creating the self-attention circuits</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/quantum_transformer.html#Usage">Usage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/quantum_transformer.html#Model-Training">Model Training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/quantum_transformer.html#Generating-Molecules">Generating Molecules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/quantum_transformer.html#Attention-Maps">Attention Maps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/afqmc.html">Quantum Enhanced Auxiliary Field Quantum Monte Carlo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/afqmc.html#Hamiltonian-preparation-for-VQE">Hamiltonian preparation for VQE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/afqmc.html#Run-VQE-with-CUDA-Q">Run VQE with CUDA-Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/afqmc.html#Auxiliary-Field-Quantum-Monte-Carlo-(AFQMC)">Auxiliary Field Quantum Monte Carlo (AFQMC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/afqmc.html#Preparation-of-the-molecular-Hamiltonian">Preparation of the molecular Hamiltonian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/afqmc.html#Preparation-of-the-trial-wave-function">Preparation of the trial wave function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/afqmc.html#Setup-of-the-AFQMC-parameters">Setup of the AFQMC parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/adapt_qaoa.html">ADAPT-QAOA algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_qaoa.html#Simulation-input:">Simulation input:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_qaoa.html#The-problem-Hamiltonian-H_C-of-the-max-cut-graph:">The problem Hamiltonian <span class="math notranslate nohighlight">\(H_C\)</span> of the max-cut graph:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_qaoa.html#Th-operator-pool-A_j:">Th operator pool <span class="math notranslate nohighlight">\(A_j\)</span>:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_qaoa.html#The-commutator-[H_C,A_j]:">The commutator <span class="math notranslate nohighlight">\([H_C,A_j]\)</span>:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_qaoa.html#Beginning-of-ADAPT-QAOA-iteration:">Beginning of ADAPT-QAOA iteration:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/adapt_vqe.html">ADAPT-VQE algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_vqe.html#Classical-pre-processing">Classical pre-processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_vqe.html#Jordan-Wigner:">Jordan Wigner:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_vqe.html#UCCSD-operator-pool">UCCSD operator pool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/adapt_vqe.html#Single-excitation">Single excitation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/adapt_vqe.html#Double-excitation">Double excitation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_vqe.html#Commutator-[H,-A_i]">Commutator [<span class="math notranslate nohighlight">\(H\)</span>, <span class="math notranslate nohighlight">\(A_i\)</span>]</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_vqe.html#Reference-State:">Reference State:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_vqe.html#Quantum-kernels:">Quantum kernels:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/adapt_vqe.html#Beginning-of-ADAPT-VQE:">Beginning of ADAPT-VQE:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/edge_detection.html">Quantum edge detection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/edge_detection.html#Image">Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/edge_detection.html#Quantum-Probability-Image-Encoding-(QPIE):">Quantum Probability Image Encoding (QPIE):</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/edge_detection.html#Below-we-show-how-to-encode-an-image-using-QPIE-in-cudaq.">Below we show how to encode an image using QPIE in cudaq.</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/edge_detection.html#Flexible-Representation-of-Quantum-Images-(FRQI):">Flexible Representation of Quantum Images (FRQI):</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/edge_detection.html#Building-the-FRQI-State:">Building the FRQI State:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/edge_detection.html#Quantum-Hadamard-Edge-Detection-(QHED)">Quantum Hadamard Edge Detection (QHED)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/edge_detection.html#Post-processing">Post-processing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/shors.html">Factoring Integers With Shor’s Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/shors.html#Shor's-algorithm">Shor’s algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/shors.html#Solving-the-order-finding-problem-classically">Solving the order-finding problem classically</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/shors.html#Solving-the-order-finding-problem-with-a-quantum-algorithm">Solving the order-finding problem with a quantum algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/shors.html#Determining-the-order-from-the-measurement-results-of-the-phase-kernel">Determining the order from the measurement results of the phase kernel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/shors.html#Postscript">Postscript</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/generate_fermionic_ham.html">Generating the electronic Hamiltonian</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/generate_fermionic_ham.html#Second-Quantized-formulation.">Second Quantized formulation.</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/generate_fermionic_ham.html#Computational-Implementation">Computational Implementation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/generate_fermionic_ham.html#(a)-Generate-the-molecular-Hamiltonian-using-Restricted-Hartree-Fock-molecular-orbitals">(a) Generate the molecular Hamiltonian using Restricted Hartree Fock molecular orbitals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/generate_fermionic_ham.html#(b)-Generate-the-molecular-Hamiltonian-using-Unrestricted-Hartree-Fock-molecular-orbitals">(b) Generate the molecular Hamiltonian using Unrestricted Hartree Fock molecular orbitals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/generate_fermionic_ham.html#(a)-Generate-the-active-space-hamiltonian-using-RHF-molecular-orbitals.">(a) Generate the active space hamiltonian using RHF molecular orbitals.</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/generate_fermionic_ham.html#(b)-Generate-the-active-space-Hamiltonian-using-the-natural-orbitals-computed-from-MP2-simulation">(b) Generate the active space Hamiltonian using the natural orbitals computed from MP2 simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/generate_fermionic_ham.html#(c)-Generate-the-active-space-Hamiltonian-computed-from-the-CASSCF-molecular-orbitals">(c) Generate the active space Hamiltonian computed from the CASSCF molecular orbitals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/generate_fermionic_ham.html#(d)-Generate-the-electronic-Hamiltonian-using-ROHF">(d) Generate the electronic Hamiltonian using ROHF</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/generate_fermionic_ham.html#(e)-Generate-electronic-Hamiltonian-using-UHF">(e) Generate electronic Hamiltonian using UHF</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/grovers.html">Grover’s Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/grovers.html#Overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/grovers.html#Problem">Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/grovers.html#Structure-of-Grover's-Algorithm">Structure of Grover’s Algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/grovers.html#Step-1:-Preparation">Step 1: Preparation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/grovers.html#Good-and-Bad-States">Good and Bad States</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/grovers.html#Step-2:-Oracle-application">Step 2: Oracle application</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/grovers.html#Step-3:-Amplitude-amplification">Step 3: Amplitude amplification</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/grovers.html#Steps-4-and-5:-Iteration-and-measurement">Steps 4 and 5: Iteration and measurement</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/quantum_pagerank.html">Quantum PageRank</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/quantum_pagerank.html#Problem-Definition">Problem Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/quantum_pagerank.html#Simulating-Quantum-PageRank-by-CUDA-Q-dynamics">Simulating Quantum PageRank by CUDA-Q dynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/quantum_pagerank.html#Breakdown-of-Terms">Breakdown of Terms</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/uccsd_wf_ansatz.html">The UCCSD Wavefunction ansatz</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/uccsd_wf_ansatz.html#What-is-UCCSD?">What is UCCSD?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/uccsd_wf_ansatz.html#Implementation-in-Quantum-Computing">Implementation in Quantum Computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/uccsd_wf_ansatz.html#Run-VQE">Run VQE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/uccsd_wf_ansatz.html#Challenges-and-consideration">Challenges and consideration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/mps_encoding.html">Approximate State Preparation using MPS Sequential Encoding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/mps_encoding.html#Ran's-approach">Ran’s approach</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/qm_mm_pe.html">QM/MM simulation: VQE within a Polarizable Embedded Framework.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/qm_mm_pe.html#Key-concepts:">Key concepts:</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/qm_mm_pe.html#PE-VQE-SCF-Algorithm-Steps">PE-VQE-SCF Algorithm Steps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/qm_mm_pe.html#Step-1:-Initialize-(Classical-pre-processing)">Step 1: Initialize (Classical pre-processing)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/qm_mm_pe.html#Step-2:-Build-the-Hamiltonian">Step 2: Build the Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/qm_mm_pe.html#Step-3:-Run-VQE">Step 3: Run VQE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/qm_mm_pe.html#Step-4:-Update-Environment">Step 4: Update Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/qm_mm_pe.html#Step-5:-Self-Consistency-Loop">Step 5: Self-Consistency Loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/qm_mm_pe.html#Requirments:">Requirments:</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/qm_mm_pe.html#Example-1:-LiH-with-2-water-molecules.">Example 1: LiH with 2 water molecules.</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/qm_mm_pe.html#VQE,-update-environment,-and-scf-loop.">VQE, update environment, and scf loop.</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/qm_mm_pe.html#Example-2:-NH3-with-46-water-molecule-using-active-space.">Example 2: NH3 with 46 water molecule using active space.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/skqd.html">Sample-Based Krylov Quantum Diagonalization (SKQD)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/skqd.html#Why-SKQD?">Why SKQD?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/skqd.html#Setup-and-Imports">Setup and Imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/skqd.html#Understanding-Krylov-Subspaces">Understanding Krylov Subspaces</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/skqd.html#What-is-a-Krylov-Subspace?">What is a Krylov Subspace?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/skqd.html#The-SKQD-Algorithm">The SKQD Algorithm</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/skqd.html#Krylov-State-Generation-via-Repeated-Evolution">Krylov State Generation via Repeated Evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/skqd.html#Quantum-Measurements-and-Sampling">Quantum Measurements and Sampling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/skqd.html#The-Sampling-Process">The Sampling Process</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/skqd.html#Classical-Post-Processing-and-Diagonalization">Classical Post-Processing and Diagonalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/skqd.html#The-SKQD-Algorithm:-Matrix-Construction-Details">The SKQD Algorithm: Matrix Construction Details</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/skqd.html#Results-Analysis-and-Convergence">Results Analysis and Convergence</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/skqd.html#What-to-Expect:">What to Expect:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html">Entanglement Accelerates Quantum Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#2.-Model-Definition">2. Model Definition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#2.1-Initial-product-state">2.1 Initial product state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#2.2-QIMF-Hamiltonian">2.2 QIMF Hamiltonian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#2.3-First-Order-Trotter-Formula-(PF1)">2.3 First-Order Trotter Formula (PF1)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#2.4-PF1-step-for-the-QIMF-partition">2.4 PF1 step for the QIMF partition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#2.5-Hamiltonian-helpers">2.5 Hamiltonian helpers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#3.-Entanglement-metrics">3. Entanglement metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#4.-Simulation-workflow">4. Simulation workflow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#4.1-Single-step-Trotter-error">4.1 Single-step Trotter error</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#4.2-Dual-trajectory-update">4.2 Dual trajectory update</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#5.-Reproducing-the-paper’s-Figure-1a">5. Reproducing the paper’s Figure 1a</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#5.1-Visualising-the-joint-behaviour">5.1 Visualising the joint behaviour</a></li>
<li class="toctree-l4"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#5.2-Interpreting-the-result">5.2 Interpreting the result</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../applications/python/entanglement_acc_hamiltonian_simulation.html#6.-References-and-further-reading">6. References and further reading</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="backends/backends.html">   Backends</a><ul>
<li class="toctree-l2"><a class="reference internal" href="backends/simulators.html">     Circuit Simulation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="backends/sims/svsims.html">     State Vector Simulators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/svsims.html#cpu">CPU</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/svsims.html#single-gpu">Single-GPU</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/svsims.html#multi-gpu-multi-node">Multi-GPU multi-node</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backends/sims/tnsims.html">     Tensor Network Simulators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/tnsims.html#multi-gpu-multi-node">Multi-GPU multi-node</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/tnsims.html#matrix-product-state">Matrix product state</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/tnsims.html#fermioniq">Fermioniq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backends/sims/mqpusims.html">     Multi-QPU Simulators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/mqpusims.html#simulate-multiple-qpus-in-parallel">Simulate Multiple QPUs in Parallel</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/mqpusims.html#multi-qpu-other-backends">Multi-QPU + Other Backends</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backends/sims/noisy.html">     Noisy Simulators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/noisy.html#trajectory-noisy-simulation">Trajectory Noisy Simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/noisy.html#density-matrix">Density Matrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/noisy.html#stim">Stim</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backends/sims/photonics.html">     Photonics Simulators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/sims/photonics.html#orca-photonics">orca-photonics</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="backends/hardware.html">     Quantum Hardware (QPUs)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="backends/hardware/iontrap.html">     Ion Trap QPUs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/iontrap.html#ionq">IonQ</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/iontrap.html#quantinuum">Quantinuum</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backends/hardware/superconducting.html">     Superconducting QPUs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/superconducting.html#anyon-technologies-anyon-computing">Anyon Technologies/Anyon Computing</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/superconducting.html#iqm">IQM</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/superconducting.html#oqc">OQC</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/superconducting.html#quantum-circuits-inc">Quantum Circuits, Inc.</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backends/hardware/neutralatom.html">     Neutral Atom QPUs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/neutralatom.html#infleqtion">Infleqtion</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/neutralatom.html#pasqal">Pasqal</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/neutralatom.html#quera-computing">QuEra Computing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backends/hardware/photonic.html">     Photonic QPUs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/photonic.html#orca-computing">ORCA Computing</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backends/hardware/qcontrol.html">     Quantum Control Systems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/hardware/qcontrol.html#quantum-machines">Quantum Machines</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="backends/dynamics_backends.html">     Dynamics Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="backends/cloud.html">     Cloud</a><ul>
<li class="toctree-l3"><a class="reference internal" href="backends/cloud/braket.html">     Amazon Braket (braket)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/cloud/braket.html#setting-credentials">Setting Credentials</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/cloud/braket.html#submission-from-c">Submission from C++</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/cloud/braket.html#submission-from-python">Submission from Python</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="backends/cloud/nvqc.html">     NVIDIA Quantum Cloud (nvqc)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="backends/cloud/nvqc.html#quick-start">Quick Start</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/cloud/nvqc.html#simulator-backend-selection">Simulator Backend Selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/cloud/nvqc.html#multiple-gpus">Multiple GPUs</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/cloud/nvqc.html#multiple-qpus-asynchronous-execution">Multiple QPUs Asynchronous Execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="backends/cloud/nvqc.html#faq">FAQ</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">   Dynamics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#operator">Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#time-dependent-dynamics">Time-Dependent Dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#super-operator-representation">Super-operator Representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#numerical-integrators">Numerical Integrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#batch-simulation">Batch simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multi-gpu-multi-node-execution">Multi-GPU Multi-Node Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cudaqx/cudaqx.html">   CUDA-QX</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cudaqx/cudaqx.html#cuda-q-solvers">CUDA-Q Solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="cudaqx/cudaqx.html#cuda-q-qec">CUDA-Q QEC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install/install.html">   Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install/local_installation.html">Local Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install/local_installation.html#introduction">Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#docker">Docker</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#known-blackwell-issues">Known Blackwell Issues</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#singularity">Singularity</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#python-wheels">Python wheels</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#pre-built-binaries">Pre-built binaries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install/local_installation.html#development-with-vs-code">Development with VS Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#using-a-docker-container">Using a Docker container</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#using-a-singularity-container">Using a Singularity container</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install/local_installation.html#connecting-to-a-remote-host">Connecting to a Remote Host</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#developing-with-remote-tunnels">Developing with Remote Tunnels</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#remote-access-via-ssh">Remote Access via SSH</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install/local_installation.html#dgx-cloud">DGX Cloud</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#get-started">Get Started</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#use-jupyterlab">Use JupyterLab</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#use-vs-code">Use VS Code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install/local_installation.html#additional-cuda-tools">Additional CUDA Tools</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#installation-via-pypi">Installation via PyPI</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#installation-in-container-images">Installation In Container Images</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/local_installation.html#installing-pre-built-binaries">Installing Pre-built Binaries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install/local_installation.html#distributed-computing-with-mpi">Distributed Computing with MPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="install/local_installation.html#updating-cuda-q">Updating CUDA-Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="install/local_installation.html#dependencies-and-compatibility">Dependencies and Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="install/local_installation.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="install/data_center_install.html">Data Center Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install/data_center_install.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="install/data_center_install.html#build-dependencies">Build Dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install/data_center_install.html#cuda">CUDA</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/data_center_install.html#toolchain">Toolchain</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="install/data_center_install.html#building-cuda-q">Building CUDA-Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="install/data_center_install.html#python-support">Python Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="install/data_center_install.html#c-support">C++ Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="install/data_center_install.html#installation-on-the-host">Installation on the Host</a><ul>
<li class="toctree-l4"><a class="reference internal" href="install/data_center_install.html#cuda-runtime-libraries">CUDA Runtime Libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="install/data_center_install.html#mpi">MPI</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="integration/integration.html">   Integration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="integration/cmake_app.html">Downstream CMake Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="integration/cuda_gpu.html">Combining CUDA with CUDA-Q</a></li>
<li class="toctree-l2"><a class="reference internal" href="integration/libraries.html">Integrating with Third-Party Libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="integration/libraries.html#calling-a-cuda-q-library-from-c">Calling a CUDA-Q library from C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="integration/libraries.html#calling-an-c-library-from-cuda-q">Calling an C++ library from CUDA-Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="integration/libraries.html#interfacing-between-binaries-compiled-with-a-different-toolchains">Interfacing between binaries compiled with a different toolchains</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extending/extending.html">   Extending</a><ul>
<li class="toctree-l2"><a class="reference internal" href="extending/backend.html">Add a new Hardware Backend</a><ul>
<li class="toctree-l3"><a class="reference internal" href="extending/backend.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="extending/backend.html#server-helper-implementation">Server Helper Implementation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="extending/backend.html#directory-structure">Directory Structure</a></li>
<li class="toctree-l4"><a class="reference internal" href="extending/backend.html#server-helper-class">Server Helper Class</a></li>
<li class="toctree-l4"><a class="reference internal" href="extending/backend.html#cmakelists-txt"><code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="extending/backend.html#target-configuration">Target Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="extending/backend.html#update-parent-cmakelists-txt">Update Parent <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="extending/backend.html#testing">Testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="extending/backend.html#unit-tests">Unit Tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="extending/backend.html#mock-server">Mock Server</a></li>
<li class="toctree-l4"><a class="reference internal" href="extending/backend.html#python-tests">Python Tests</a></li>
<li class="toctree-l4"><a class="reference internal" href="extending/backend.html#integration-tests">Integration Tests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="extending/backend.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="extending/backend.html#example-usage">Example Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="extending/backend.html#code-review">Code Review</a></li>
<li class="toctree-l3"><a class="reference internal" href="extending/backend.html#maintaining-a-backend">Maintaining a Backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="extending/backend.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="extending/nvqir_simulator.html">Create a new NVQIR Simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="extending/nvqir_simulator.html#circuitsimulator"><code class="code docutils literal notranslate"><span class="pre">CircuitSimulator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="extending/nvqir_simulator.html#let-s-see-this-in-action">Let’s see this in action</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="extending/cudaq_ir.html">Working with CUDA-Q IR</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending/mlir_pass.html">Create an MLIR Pass for CUDA-Q</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../specification/index.html">   Specifications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../specification/cudaq.html">   Language Specification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/machine_model.html">1. Machine Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/namespace.html">2. Namespace and Standard</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/types.html">3. Quantum Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/types.html#cudaq-qudit-levels">3.1. <code class="code docutils literal notranslate"><span class="pre">cudaq::qudit&lt;Levels&gt;</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/types.html#cudaq-qubit">3.2. <code class="code docutils literal notranslate"><span class="pre">cudaq::qubit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/types.html#quantum-containers">3.3. Quantum Containers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/operators.html">4. Quantum Operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/operators.html#cudaq-spin-op">4.1. <code class="code docutils literal notranslate"><span class="pre">cudaq::spin_op</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/operations.html">5. Quantum Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/operations.html#operations-on-cudaq-qubit">5.1. Operations on <code class="code docutils literal notranslate"><span class="pre">cudaq::qubit</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/kernels.html">6. Quantum Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/synthesis.html">7. Sub-circuit Synthesis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/control_flow.html">8. Control Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/dynamic_kernels.html">9. Just-in-Time Kernel Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/patterns.html">10. Quantum Patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/patterns.html#compute-action-uncompute">10.1. Compute-Action-Uncompute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/platform.html">11. Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/algorithmic_primitives.html">12. Algorithmic Primitives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/algorithmic_primitives.html#cudaq-sample">12.1. <code class="code docutils literal notranslate"><span class="pre">cudaq::sample</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/algorithmic_primitives.html#cudaq-run">12.2. <code class="code docutils literal notranslate"><span class="pre">cudaq::run</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/algorithmic_primitives.html#cudaq-observe">12.3. <code class="code docutils literal notranslate"><span class="pre">cudaq::observe</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/algorithmic_primitives.html#cudaq-optimizer-deprecated-functionality-moved-to-cuda-q-libraries">12.4. <code class="code docutils literal notranslate"><span class="pre">cudaq::optimizer</span></code> (deprecated, functionality moved to CUDA-Q libraries)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/algorithmic_primitives.html#cudaq-gradient-deprecated-functionality-moved-to-cuda-q-libraries">12.5. <code class="code docutils literal notranslate"><span class="pre">cudaq::gradient</span></code> (deprecated, functionality moved to CUDA-Q libraries)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../specification/cudaq/examples.html">13. Example Programs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/examples.html#hello-world-simple-bell-state">13.1. Hello World - Simple Bell State</a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/examples.html#ghz-state-preparation-and-sampling">13.2. GHZ State Preparation and Sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/examples.html#quantum-phase-estimation">13.3. Quantum Phase Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/examples.html#deuteron-binding-energy-parameter-sweep">13.4. Deuteron Binding Energy Parameter Sweep</a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/examples.html#grover-s-algorithm">13.5. Grover’s Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../specification/cudaq/examples.html#iterative-phase-estimation">13.6. Iterative Phase Estimation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../specification/quake-dialect.html">   Quake Specification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../specification/quake-dialect.html#general-introduction">General Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../specification/quake-dialect.html#motivation">Motivation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">   API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/languages/cpp_api.html">C++ API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#operators">Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#quantum">Quantum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#common">Common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#noise-modeling">Noise Modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#kernel-builder">Kernel Builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#algorithms">Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#platform">Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#utilities">Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#namespaces">Namespaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/languages/python_api.html">Python API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#program-construction">Program Construction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.make_kernel"><code class="docutils literal notranslate"><span class="pre">make_kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.PyKernel"><code class="docutils literal notranslate"><span class="pre">PyKernel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.Kernel"><code class="docutils literal notranslate"><span class="pre">Kernel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.PyKernelDecorator"><code class="docutils literal notranslate"><span class="pre">PyKernelDecorator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.kernel"><code class="docutils literal notranslate"><span class="pre">kernel()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#kernel-execution">Kernel Execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.sample"><code class="docutils literal notranslate"><span class="pre">sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.sample_async"><code class="docutils literal notranslate"><span class="pre">sample_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.run_async"><code class="docutils literal notranslate"><span class="pre">run_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.observe"><code class="docutils literal notranslate"><span class="pre">observe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.observe_async"><code class="docutils literal notranslate"><span class="pre">observe_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.get_state"><code class="docutils literal notranslate"><span class="pre">get_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.get_state_async"><code class="docutils literal notranslate"><span class="pre">get_state_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.vqe"><code class="docutils literal notranslate"><span class="pre">vqe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.draw"><code class="docutils literal notranslate"><span class="pre">draw()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.translate"><code class="docutils literal notranslate"><span class="pre">translate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.estimate_resources"><code class="docutils literal notranslate"><span class="pre">estimate_resources()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#backend-configuration">Backend Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.has_target"><code class="docutils literal notranslate"><span class="pre">has_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.get_target"><code class="docutils literal notranslate"><span class="pre">get_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.get_targets"><code class="docutils literal notranslate"><span class="pre">get_targets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.set_target"><code class="docutils literal notranslate"><span class="pre">set_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.reset_target"><code class="docutils literal notranslate"><span class="pre">reset_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.set_noise"><code class="docutils literal notranslate"><span class="pre">set_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.unset_noise"><code class="docutils literal notranslate"><span class="pre">unset_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.register_set_target_callback"><code class="docutils literal notranslate"><span class="pre">register_set_target_callback()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.unregister_set_target_callback"><code class="docutils literal notranslate"><span class="pre">unregister_set_target_callback()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.cudaq.apply_noise"><code class="docutils literal notranslate"><span class="pre">cudaq.apply_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.initialize_cudaq"><code class="docutils literal notranslate"><span class="pre">initialize_cudaq()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.num_available_gpus"><code class="docutils literal notranslate"><span class="pre">num_available_gpus()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.set_random_seed"><code class="docutils literal notranslate"><span class="pre">set_random_seed()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#dynamics">Dynamics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.evolve"><code class="docutils literal notranslate"><span class="pre">evolve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.evolve_async"><code class="docutils literal notranslate"><span class="pre">evolve_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.Schedule"><code class="docutils literal notranslate"><span class="pre">Schedule</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.dynamics.integrator.BaseIntegrator"><code class="docutils literal notranslate"><span class="pre">BaseIntegrator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.dynamics.helpers.InitialState"><code class="docutils literal notranslate"><span class="pre">InitialState</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.InitialStateType"><code class="docutils literal notranslate"><span class="pre">InitialStateType</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.IntermediateResultSave"><code class="docutils literal notranslate"><span class="pre">IntermediateResultSave</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#operators">Operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.operators.OperatorSum"><code class="docutils literal notranslate"><span class="pre">OperatorSum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.operators.ProductOperator"><code class="docutils literal notranslate"><span class="pre">ProductOperator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.operators.ElementaryOperator"><code class="docutils literal notranslate"><span class="pre">ElementaryOperator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.operators.ScalarOperator"><code class="docutils literal notranslate"><span class="pre">ScalarOperator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.operators.RydbergHamiltonian"><code class="docutils literal notranslate"><span class="pre">RydbergHamiltonian</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.SuperOperator"><code class="docutils literal notranslate"><span class="pre">SuperOperator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.operators.define"><code class="docutils literal notranslate"><span class="pre">operators.define()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.operators.instantiate"><code class="docutils literal notranslate"><span class="pre">operators.instantiate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#spin-operators">Spin Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#fermion-operators">Fermion Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#boson-operators">Boson Operators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#general-operators">General Operators</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#data-types">Data Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.SimulationPrecision"><code class="docutils literal notranslate"><span class="pre">SimulationPrecision</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.Target"><code class="docutils literal notranslate"><span class="pre">Target</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.State"><code class="docutils literal notranslate"><span class="pre">State</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.Tensor"><code class="docutils literal notranslate"><span class="pre">Tensor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.QuakeValue"><code class="docutils literal notranslate"><span class="pre">QuakeValue</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.qubit"><code class="docutils literal notranslate"><span class="pre">qubit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.qreg"><code class="docutils literal notranslate"><span class="pre">qreg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.qvector"><code class="docutils literal notranslate"><span class="pre">qvector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.ComplexMatrix"><code class="docutils literal notranslate"><span class="pre">ComplexMatrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.SampleResult"><code class="docutils literal notranslate"><span class="pre">SampleResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.AsyncSampleResult"><code class="docutils literal notranslate"><span class="pre">AsyncSampleResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.ObserveResult"><code class="docutils literal notranslate"><span class="pre">ObserveResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.AsyncObserveResult"><code class="docutils literal notranslate"><span class="pre">AsyncObserveResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.AsyncStateResult"><code class="docutils literal notranslate"><span class="pre">AsyncStateResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.OptimizationResult"><code class="docutils literal notranslate"><span class="pre">OptimizationResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.EvolveResult"><code class="docutils literal notranslate"><span class="pre">EvolveResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.AsyncEvolveResult"><code class="docutils literal notranslate"><span class="pre">AsyncEvolveResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.Resources"><code class="docutils literal notranslate"><span class="pre">Resources</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#optimizers">Optimizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#gradients">Gradients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#noisy-simulation">Noisy Simulation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#mpi-submodule">MPI Submodule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.initialize"><code class="docutils literal notranslate"><span class="pre">initialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.rank"><code class="docutils literal notranslate"><span class="pre">rank()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.num_ranks"><code class="docutils literal notranslate"><span class="pre">num_ranks()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.all_gather"><code class="docutils literal notranslate"><span class="pre">all_gather()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.broadcast"><code class="docutils literal notranslate"><span class="pre">broadcast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.is_initialized"><code class="docutils literal notranslate"><span class="pre">is_initialized()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.finalize"><code class="docutils literal notranslate"><span class="pre">finalize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#orca-submodule">ORCA Submodule</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.orca.sample"><code class="docutils literal notranslate"><span class="pre">sample()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/default_ops.html">Quantum Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/default_ops.html#unitary-operations-on-qubits">Unitary Operations on Qubits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#x"><code class="code docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#y"><code class="code docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#z"><code class="code docutils literal notranslate"><span class="pre">z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#h"><code class="code docutils literal notranslate"><span class="pre">h</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#r1"><code class="code docutils literal notranslate"><span class="pre">r1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#rx"><code class="code docutils literal notranslate"><span class="pre">rx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#ry"><code class="code docutils literal notranslate"><span class="pre">ry</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#rz"><code class="code docutils literal notranslate"><span class="pre">rz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#s"><code class="code docutils literal notranslate"><span class="pre">s</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#t"><code class="code docutils literal notranslate"><span class="pre">t</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#swap"><code class="code docutils literal notranslate"><span class="pre">swap</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#u3"><code class="code docutils literal notranslate"><span class="pre">u3</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/default_ops.html#adjoint-and-controlled-operations">Adjoint and Controlled Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/default_ops.html#measurements-on-qubits">Measurements on Qubits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#mz"><code class="code docutils literal notranslate"><span class="pre">mz</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#mx"><code class="code docutils literal notranslate"><span class="pre">mx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#my"><code class="code docutils literal notranslate"><span class="pre">my</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/default_ops.html#user-defined-custom-operations">User-Defined Custom Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/default_ops.html#photonic-operations-on-qudits">Photonic Operations on Qudits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#create"><code class="code docutils literal notranslate"><span class="pre">create</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#annihilate"><code class="code docutils literal notranslate"><span class="pre">annihilate</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#phase-shift"><code class="code docutils literal notranslate"><span class="pre">phase_shift</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#beam-splitter"><code class="code docutils literal notranslate"><span class="pre">beam_splitter</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/default_ops.html#id1"><code class="code docutils literal notranslate"><span class="pre">mz</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">   Other Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #76b900" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NVIDIA CUDA-Q</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Dynamics Simulation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="backends/cloud/nvqc.html" class="btn btn-neutral float-left" title="NVIDIA Quantum Cloud" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cudaqx/cudaqx.html" class="btn btn-neutral float-right" title="CUDA-QX" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="dynamics-simulation">
<h1>Dynamics Simulation<a class="headerlink" href="#dynamics-simulation" title="Permalink to this heading">¶</a></h1>
<p id="dynamics">CUDA-Q enables the design, simulation and execution of quantum dynamics via
the <code class="docutils literal notranslate"><span class="pre">evolve</span></code> API. Specifically, this API allows us to solve the time evolution
of quantum systems or models. In the simulation mode, CUDA-Q provides the <code class="docutils literal notranslate"><span class="pre">dynamics</span></code>
backend target, which is based on the cuQuantum library, optimized for performance and scale
on NVIDIA GPU.</p>
<section id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this heading">¶</a></h2>
<p>In the example below, we demonstrate a simple time evolution simulation workflow comprising of the
following steps:</p>
<ol class="arabic simple">
<li><p>Define a quantum system model</p></li>
</ol>
<p>A quantum system model is defined by a Hamiltonian.
For example, a superconducting <a class="reference external" href="https://en.wikipedia.org/wiki/Transmon">transmon</a> qubit can be modeled by the following Hamiltonian</p>
<div class="math notranslate nohighlight">
\[H = \frac{\omega_z}{2} \sigma_z + \omega_x \cos(\omega_d t)\sigma_x,\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_z\)</span> and <span class="math notranslate nohighlight">\(\sigma_x\)</span> are Pauli Z and X operators, respectively.</p>
<p>Using CUDA-Q <code class="code docutils literal notranslate"><span class="pre">operator</span></code>, the above time-dependent Hamiltonian can be set up as follows.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--0-input--1" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">omega_z</span> <span class="o">=</span> <span class="mf">6.5</span>
<span class="n">omega_x</span> <span class="o">=</span> <span class="mf">4.0</span>
<span class="n">omega_d</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cudaq</span><span class="w"> </span><span class="kn">import</span> <span class="n">spin</span><span class="p">,</span> <span class="n">ScalarOperator</span>

<span class="c1"># Qubit Hamiltonian</span>
<span class="n">hamiltonian</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">omega_z</span> <span class="o">*</span> <span class="n">spin</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Add modulated driving term to the Hamiltonian</span>
<span class="n">hamiltonian</span> <span class="o">+=</span> <span class="n">omega_x</span> <span class="o">*</span> <span class="n">ScalarOperator</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega_d</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="n">spin</span><span class="o">.</span><span class="n">x</span><span class="p">(</span>
    <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>In particular, <code class="code docutils literal notranslate"><span class="pre">ScalarOperator</span></code> provides an easy way to model arbitrary time-dependent control signals.
Details about CUDA-Q <code class="code docutils literal notranslate"><span class="pre">operator</span></code>, including builtin operators that it supports can be found <a class="reference internal" href="#operators"><span class="std std-ref">here</span></a>.</p>
</div>
<input class="tab-input" id="tab-set--0-input--2" name="tab-set--0" type="radio"><label class="tab-label" for="tab-set--0-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Parameters</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">omega_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">6.5</span><span class="p">;</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">omega_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">4.0</span><span class="p">;</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">omega_d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Qubit Hamiltonian</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spin_op</span><span class="p">(</span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">omega_z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spin_op</span><span class="o">::</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// Time dependent modulation</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">mod_func</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="p">[</span><span class="n">omega_d</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">parameter_map</span><span class="w"> </span><span class="o">&amp;</span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">it</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">params</span><span class="p">.</span><span class="n">end</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">it</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">real</span><span class="p">();</span>
<span class="w">        </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cos</span><span class="p">(</span><span class="n">omega_d</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;Cannot find the time parameter.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="n">hamiltonian</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">mod_func</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spin_op</span><span class="o">::</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">omega_x</span><span class="p">;</span>
</pre></div>
</div>
<p>Details about CUDA-Q <code class="code docutils literal notranslate"><span class="pre">operator</span></code>, including builtin operators that it supports can be found <a class="reference internal" href="#operators"><span class="std std-ref">here</span></a>.</p>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Setup the evolution simulation</p></li>
</ol>
<p>The below code snippet shows how to simulate the time-evolution of the above system
with <code class="code docutils literal notranslate"><span class="pre">cudaq.evolve</span></code>.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--1-input--1" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cudaq</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cudaq.dynamics</span><span class="w"> </span><span class="kn">import</span> <span class="n">Schedule</span>

<span class="c1"># Set the target to our dynamics simulator</span>
<span class="n">cudaq</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="s2">&quot;dynamics&quot;</span><span class="p">)</span>

<span class="c1"># Dimensions of sub-systems: a single two-level system.</span>
<span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="c1"># Initial state of the system (ground state).</span>
<span class="n">rho0</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">complex128</span><span class="p">))</span>

<span class="c1"># Schedule of time steps.</span>
<span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t_final</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">)</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="n">Schedule</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>

<span class="c1"># Run the simulation.</span>
<span class="n">evolution_result</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="p">,</span>
    <span class="n">schedule</span><span class="p">,</span>
    <span class="n">rho0</span><span class="p">,</span>
    <span class="n">observables</span><span class="o">=</span><span class="p">[</span><span class="n">spin</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">spin</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">spin</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span>
    <span class="n">collapse_operators</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">store_intermediate_results</span><span class="o">=</span><span class="n">cudaq</span><span class="o">.</span><span class="n">IntermediateResultSave</span><span class="o">.</span><span class="n">ALL</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--1-input--2" name="tab-set--1" type="radio"><label class="tab-label" for="tab-set--1-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">t_final</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Define dimensions of subsystem (single two-level system)</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">dimension_map</span><span class="w"> </span><span class="n">dimensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">}};</span>

<span class="w">    </span><span class="c1">// Initial state (ground state)</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">psi0</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">cudaq</span><span class="o">::</span><span class="n">state</span><span class="o">::</span><span class="n">from_data</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="p">{</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">});</span>

<span class="w">    </span><span class="c1">// Schedule of time steps</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">steps</span><span class="p">(</span><span class="n">n_steps</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n_steps</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
<span class="w">      </span><span class="n">steps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t_final</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">n_steps</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">    </span><span class="n">schedule</span><span class="w"> </span><span class="n">schedule</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;t&quot;</span><span class="p">});</span>

<span class="w">    </span><span class="c1">// Numerical integrator</span>
<span class="w">    </span><span class="c1">// Here we choose a Runge-`Kutta` method for time evolution.</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">integrators</span><span class="o">::</span><span class="n">runge_kutta</span><span class="w"> </span><span class="nf">integrator</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Observables to track</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">observables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="w">                        </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)};</span>

<span class="w">    </span><span class="c1">// Run simulation</span>
<span class="w">    </span><span class="c1">// We evolve the system under the defined Hamiltonian. No collapsed</span>
<span class="w">    </span><span class="c1">// operators are provided (closed system evolution). The evolution returns</span>
<span class="w">    </span><span class="c1">// expectation values for all defined observables at each time step.</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">evolution_result</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">cudaq</span><span class="o">::</span><span class="n">evolve</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span><span class="w"> </span><span class="n">dimensions</span><span class="p">,</span><span class="w"> </span><span class="n">schedule</span><span class="p">,</span><span class="w"> </span><span class="n">psi0</span><span class="p">,</span><span class="w"> </span><span class="n">integrator</span><span class="p">,</span><span class="w"> </span><span class="p">{},</span>
<span class="w">                      </span><span class="n">observables</span><span class="p">,</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">IntermediateResultSave</span><span class="o">::</span><span class="n">All</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Specifically, we need to set up the simulation by providing:</p>
<ul class="simple">
<li><p>The system model in terms of a Hamiltonian as well as any decoherence terms, so-called <code class="code docutils literal notranslate"><span class="pre">collapse_operators</span></code>.</p></li>
<li><p>The dimensionality of component systems in the model. CUDA-Q <code class="code docutils literal notranslate"><span class="pre">evolve</span></code> allows users to model arbitrary multi-level systems, such as photonic Fock space.</p></li>
<li><p>The initial quantum state.</p></li>
<li><p>The time schedule, aka time steps, of the evolution.</p></li>
<li><p>Any ‘observable’ operator that we want to measure the expectation value with respect to the evolving state.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, <code class="code docutils literal notranslate"><span class="pre">evolve</span></code> will only return the final state and expectation values.
To save intermediate results (at each time step specified in the schedule),
the <code class="code docutils literal notranslate"><span class="pre">store_intermediate_results</span></code> flag must be set to <code class="code docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
<ol class="arabic simple" start="3">
<li><p>Retrieve and plot the results</p></li>
</ol>
<p>Once the simulation is complete, we can retrieve the final state and the expectation values
as well as intermediate values at each time step (with <code class="code docutils literal notranslate"><span class="pre">store_intermediate_results=cudaq.IntermediateResultSave.ALL</span></code>).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Storing intermediate states can be memory-intensive, especially for large systems.
If you only need the intermediate expectation values, you can set <code class="code docutils literal notranslate"><span class="pre">store_intermediate_results</span></code> to
<code class="code docutils literal notranslate"><span class="pre">cudaq.IntermediateResultSave.EXPECTATION_VALUES</span></code> (Python) / <code class="code docutils literal notranslate"><span class="pre">cudaq::IntermediateResultSave::ExpectationValue</span></code> (C++) instead.</p>
</div>
<p>For example, we can plot the Pauli expectation value for the above simulation as follows.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--2-input--1" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">get_result</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">idx</span><span class="p">,</span> <span class="n">res</span><span class="p">:</span> <span class="p">[</span>
    <span class="n">exp_vals</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">expectation</span><span class="p">()</span> <span class="k">for</span> <span class="n">exp_vals</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">expectation_values</span><span class="p">()</span>
<span class="p">]</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">get_result</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">evolution_result</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">get_result</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">evolution_result</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="n">get_result</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">evolution_result</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Expectation value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s2">&quot;Sigma-X&quot;</span><span class="p">,</span> <span class="s2">&quot;Sigma-Y&quot;</span><span class="p">,</span> <span class="s2">&quot;Sigma-Z&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>In particular, for each time step, <code class="code docutils literal notranslate"><span class="pre">evolve</span></code> captures an array of expectation values, one for each
observable. Hence, we convert them into sequences for plotting purposes.</p>
</div>
<input class="tab-input" id="tab-set--2-input--2" name="tab-set--2" type="radio"><label class="tab-label" for="tab-set--2-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Extract and print results</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">steps</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">ex</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="n">evolution_result</span><span class="p">.</span><span class="n">expectation_values</span><span class="p">.</span><span class="n">value</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">expectation</span><span class="p">();</span>
<span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">ey</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="n">evolution_result</span><span class="p">.</span><span class="n">expectation_values</span><span class="p">.</span><span class="n">value</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">expectation</span><span class="p">();</span>
<span class="w">      </span><span class="kt">double</span><span class="w"> </span><span class="n">ez</span><span class="w"> </span><span class="o">=</span>
<span class="w">          </span><span class="n">evolution_result</span><span class="p">.</span><span class="n">expectation_values</span><span class="p">.</span><span class="n">value</span><span class="p">()[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">].</span><span class="n">expectation</span><span class="p">();</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">steps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ex</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ey</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">ez</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Examples that illustrate how to use the <code class="docutils literal notranslate"><span class="pre">dynamics</span></code> target are available
in the <a class="reference external" href="https://github.com/NVIDIA/cuda-quantum/tree/main/docs/sphinx/examples/python/dynamics">CUDA-Q repository</a>.</p>
</section>
<section id="operator">
<h2>Operator<a class="headerlink" href="#operator" title="Permalink to this heading">¶</a></h2>
<p id="operators">CUDA-Q provides builtin definitions for commonly-used operators,
such as the ladder operators (<span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(a^\dagger\)</span>) of a harmonic oscillator,
the Pauli spin operators for a two-level system, etc.</p>
<p>Here is a list of those operators.</p>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Builtin Operators</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">identity</span></code></p></td>
<td><p>Identity operator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">zero</span></code></p></td>
<td><p>Zero or null operator</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">annihilate</span></code></p></td>
<td><p>Bosonic annihilation operator (<span class="math notranslate nohighlight">\(a\)</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">create</span></code></p></td>
<td><p>Bosonic creation operator (<span class="math notranslate nohighlight">\(a^\dagger\)</span>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">number</span></code></p></td>
<td><p>Number operator of a bosonic mode (equivalent to <span class="math notranslate nohighlight">\(a^\dagger a\)</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">parity</span></code></p></td>
<td><p>Parity operator of a bosonic mode (defined as <span class="math notranslate nohighlight">\(e^{i\pi a^\dagger a}\)</span>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">displace</span></code></p></td>
<td><p>Displacement operator of complex amplitude <span class="math notranslate nohighlight">\(\alpha\)</span> (<code class="code docutils literal notranslate"><span class="pre">displacement</span></code>). It is defined as <span class="math notranslate nohighlight">\(e^{\alpha a^\dagger - \alpha^* a}\)</span>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">squeeze</span></code></p></td>
<td><p>Squeezing operator of complex squeezing amplitude <span class="math notranslate nohighlight">\(z\)</span> (<code class="code docutils literal notranslate"><span class="pre">squeezing</span></code>). It is defined as <span class="math notranslate nohighlight">\(\exp(\frac{1}{2}(z^*a^2 - z a^{\dagger 2}))\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">position</span></code></p></td>
<td><p>Position operator (equivalent to <span class="math notranslate nohighlight">\((a^\dagger + a)/2\)</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">momentum</span></code></p></td>
<td><p>Momentum operator (equivalent to <span class="math notranslate nohighlight">\(i(a^\dagger - a)/2\)</span>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">spin.x</span></code></p></td>
<td><p>Pauli <span class="math notranslate nohighlight">\(\sigma_x\)</span> operator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">spin.y</span></code></p></td>
<td><p>Pauli <span class="math notranslate nohighlight">\(\sigma_y\)</span> operator</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">spin.z</span></code></p></td>
<td><p>Pauli <span class="math notranslate nohighlight">\(\sigma_z\)</span> operator</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">spin.plus</span></code></p></td>
<td><p>Pauli raising (<span class="math notranslate nohighlight">\(\sigma_+\)</span>) operator</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">spin.minus</span></code></p></td>
<td><p>Pauli lowering (<span class="math notranslate nohighlight">\(\sigma_-\)</span>) operator</p></td>
</tr>
</tbody>
</table>
<p>As an example, let’s look at the Jaynes-Cummings model, which describes
the interaction between a two-level atom and a light (Boson) field.</p>
<p>Mathematically, the Hamiltonian can be expressed as</p>
<div class="math notranslate nohighlight">
\[H = \omega_c a^\dagger a + \omega_a \frac{\sigma_z}{2} + \frac{\Omega}{2}(a\sigma_+ + a^\dagger \sigma_-).\]</div>
<p>This Hamiltonian can be converted to CUDA-Q <code class="code docutils literal notranslate"><span class="pre">Operator</span></code> representation with</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--3-input--1" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">cudaq</span><span class="w"> </span><span class="kn">import</span> <span class="n">operators</span>

<span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">omega_c</span> <span class="o">*</span> <span class="n">operators</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">operators</span><span class="o">.</span><span class="n">annihilate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> \
                <span class="o">+</span> <span class="p">(</span><span class="n">omega_a</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">spin</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> \
                <span class="o">+</span> <span class="p">(</span><span class="n">Omega</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">operators</span><span class="o">.</span><span class="n">annihilate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">spin</span><span class="o">.</span><span class="n">plus</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">operators</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">spin</span><span class="o">.</span><span class="n">minus</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--3-input--2" name="tab-set--3" type="radio"><label class="tab-label" for="tab-set--3-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Jaynes-Cummings Hamiltonian</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">jc_hamiltonian</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">omega_c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">boson_op</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">boson_op</span><span class="o">::</span><span class="n">annihilate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="p">(</span><span class="n">omega_a</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spin_op</span><span class="o">::</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">        </span><span class="p">(</span><span class="n">Omega</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">boson_op</span><span class="o">::</span><span class="n">annihilate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spin_op</span><span class="o">::</span><span class="n">plus</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">                         </span><span class="n">boson_op</span><span class="o">::</span><span class="n">create</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">spin_op</span><span class="o">::</span><span class="n">minus</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<p>In the above code snippet, we map the cavity light field to degree index 1 and the two-level atom to degree index 0.
The description of composite quantum system dynamics is independent from the Hilbert space of the system components.
The latter is specified by the dimension map that is provided to the <code class="code docutils literal notranslate"><span class="pre">cudaq.evolve</span></code> call.</p>
<p>Builtin operators support both dense and multi-diagonal sparse formats.
Depending on the sparsity of operator matrix and/or the sub-system dimension, CUDA-Q will
either use the dense or multi-diagonal data formats for optimal performance.</p>
<p>Specifically, the following environment variable options are applicable to the <code class="code docutils literal notranslate"><span class="pre">dynamics</span></code> target.
Any environment variables must be set prior to setting the target or running “<code class="code docutils literal notranslate"><span class="pre">import</span> <span class="pre">cudaq</span></code>”.</p>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text"><strong>Additional environment variable options for the `dynamics` target</strong></span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 30%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Option</p></td>
<td><p>Value</p></td>
<td><p>Description</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">CUDAQ_DYNAMICS_MIN_MULTIDIAGONAL_DIMENSION</span></code></p></td>
<td><p>Non-negative number</p></td>
<td><p>The minimum sub-system dimension on which the operator acts to activate multi-diagonal data format. For example, if a minimum dimension configuration of <code class="code docutils literal notranslate"><span class="pre">N</span></code> is set, all operators acting on degrees of freedom (sub-system) whose dimension is less than or equal to <code class="code docutils literal notranslate"><span class="pre">N</span></code> would always use the dense format. The final data format to be used depends on the next configuration. The default is 4.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">CUDAQ_DYNAMICS_MAX_DIAGONAL_COUNT_FOR_MULTIDIAGONAL</span></code></p></td>
<td><p>Non-negative number</p></td>
<td><p>The maximum number of diagonals for multi-diagonal representation. If the operator matrix has more diagonals than this value, the dense format will be used. Default is 1, i.e., operators with only one diagonal line (center, lower, or upper) will use the multi-diagonal sparse storage.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="time-dependent-dynamics">
<h2>Time-Dependent Dynamics<a class="headerlink" href="#time-dependent-dynamics" title="Permalink to this heading">¶</a></h2>
<p id="time-dependent">In the previous examples of operator construction, we assumed that the systems under consideration were described by time-independent Hamiltonian.
However, we may want to simulate systems whose Hamiltonian operators have explicit time dependence.</p>
<p>CUDA-Q provides multiple ways to construct time-dependent operators.</p>
<ol class="arabic simple">
<li><p>Time-dependent coefficient</p></li>
</ol>
<p>CUDA-Q <code class="code docutils literal notranslate"><span class="pre">ScalarOperator</span></code> can be used to wrap a Python/C++ function that returns the coefficient value at a specific time.</p>
<p>As an example, we will look at a time-dependent Hamiltonian of the form <span class="math notranslate nohighlight">\(H = H_0 + f(t)H_1\)</span>,
where <span class="math notranslate nohighlight">\(f(t)\)</span> is the time-dependent driving strength given as <span class="math notranslate nohighlight">\(cos(\omega t)\)</span>.</p>
<p>The following code sets up the problem</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--4-input--1" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the static (drift) and control terms</span>
<span class="n">H0</span> <span class="o">=</span> <span class="n">spin</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">H1</span> <span class="o">=</span> <span class="n">spin</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">H0</span> <span class="o">+</span> <span class="n">ScalarOperator</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="n">H1</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--4-input--2" name="tab-set--4" type="radio"><label class="tab-label" for="tab-set--4-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Hamiltonian with driving frequency</span>
<span class="w">    </span><span class="kt">double</span><span class="w"> </span><span class="n">omega</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">M_PI</span><span class="p">;</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">H0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spin_op</span><span class="o">::</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">H1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spin_op</span><span class="o">::</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">mod_func</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="p">[</span><span class="n">omega</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span>
<span class="w">                    </span><span class="o">&amp;</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="k">auto</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parameters</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">);</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">entry</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">parameters</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;Cannot find value of expected parameter&quot;</span><span class="p">);</span>
<span class="w">          </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">real</span><span class="p">();</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">driven_hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">H0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mod_func</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">H1</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Time-dependent operator</p></li>
</ol>
<p>We can also construct a time-dependent operator from a function that returns a complex matrix representing the time dynamics of
that operator.</p>
<p>As an example, let’s looks at the <a class="reference external" href="https://en.wikipedia.org/wiki/Displacement_operator">displacement operator</a>. It can be defined as follows:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--5-input--1" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cudaq</span><span class="w"> </span><span class="kn">import</span> <span class="n">operators</span><span class="p">,</span> <span class="n">NumericType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">numpy.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">NDArray</span>


<span class="k">def</span><span class="w"> </span><span class="nf">displacement_matrix</span><span class="p">(</span>
        <span class="n">dimension</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">displacement</span><span class="p">:</span> <span class="n">NumericType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">complexfloating</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the displacement operator matrix.</span>
<span class="sd">    Args:</span>
<span class="sd">        displacement: Amplitude of the displacement operator.</span>
<span class="sd">            See also https://en.wikipedia.org/wiki/Displacement_operator.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">displacement</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">displacement</span><span class="p">)</span>
    <span class="n">term1</span> <span class="o">=</span> <span class="n">displacement</span> <span class="o">*</span> <span class="n">operators</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">dimension</span><span class="p">})</span>
    <span class="n">term2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">displacement</span><span class="p">)</span> <span class="o">*</span> <span class="n">operators</span><span class="o">.</span><span class="n">annihilate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">(</span>
        <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="n">dimension</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">expm</span><span class="p">(</span><span class="n">term1</span> <span class="o">-</span> <span class="n">term2</span><span class="p">)</span>


<span class="c1"># The second argument here indicates the defined operator</span>
<span class="c1"># acts on a single degree of freedom, which can have any dimension.</span>
<span class="c1"># An argument [2], for example, would indicate that it can only</span>
<span class="c1"># act on a single degree of freedom with dimension two.</span>
<span class="n">operators</span><span class="o">.</span><span class="n">define</span><span class="p">(</span><span class="s2">&quot;displace&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">displacement_matrix</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">displacement</span><span class="p">(</span><span class="n">degree</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">operators</span><span class="o">.</span><span class="n">MatrixOperatorElement</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Instantiates a displacement operator acting on the given degree of freedom.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">operators</span><span class="o">.</span><span class="n">instantiate</span><span class="p">(</span><span class="s2">&quot;displace&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">degree</span><span class="p">])</span>


</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--5-input--2" name="tab-set--5" type="radio"><label class="tab-label" for="tab-set--5-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">displacement_matrix</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="p">[](</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int64_t</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dimensions</span><span class="p">,</span>
<span class="w">           </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">unordered_map</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="p">,</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span>
<span class="w">               </span><span class="o">&amp;</span><span class="n">parameters</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">complex_matrix</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Returns the displacement operator matrix.</span>
<span class="w">      </span><span class="c1">//  Args:</span>
<span class="w">      </span><span class="c1">//   - displacement: Amplitude of the displacement operator.</span>
<span class="w">      </span><span class="c1">// See also https://en.wikipedia.org/wiki/Displacement_operator.</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">dimension</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parameters</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;displacement&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">entry</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">parameters</span><span class="p">.</span><span class="n">end</span><span class="p">())</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;missing value for parameter &#39;displacement&#39;&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">displacement_amplitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entry</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">;</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">complex_matrix</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span><span class="w"> </span><span class="n">dimension</span><span class="p">);</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">annihilate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">complex_matrix</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span><span class="w"> </span><span class="n">dimension</span><span class="p">);</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">dimension</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">create</span><span class="p">[{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">}]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">        </span><span class="n">annihilate</span><span class="p">[{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">}]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">term1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">displacement_amplitude</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">create</span><span class="p">;</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">term2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">conj</span><span class="p">(</span><span class="n">displacement_amplitude</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">annihilate</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">term1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">term2</span><span class="p">).</span><span class="n">exponential</span><span class="p">();</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">matrix_handler</span><span class="o">::</span><span class="n">define</span><span class="p">(</span><span class="s">&quot;displace_op&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">-1</span><span class="p">},</span><span class="w"> </span><span class="n">displacement_matrix</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Instantiate a displacement operator acting on the given degree of</span>
<span class="w">    </span><span class="c1">// freedom.</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">displacement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[](</span><span class="n">std</span><span class="o">::</span><span class="kt">size_t</span><span class="w"> </span><span class="n">degree</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">matrix_handler</span><span class="o">::</span><span class="n">instantiate</span><span class="p">(</span><span class="s">&quot;displace_op&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">degree</span><span class="p">});</span>
<span class="w">    </span><span class="p">};</span>
</pre></div>
</div>
</div>
</div>
<p>The defined operator is parameterized by the <code class="code docutils literal notranslate"><span class="pre">displacement</span></code> amplitude. To create simulate the evolution of an
operator under a time dependent displacement amplitude, we can define how the amplitude changes in time:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--6-input--1" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cudaq</span>

<span class="c1"># Define a system consisting of a single degree of freedom (0) with dimension 3.</span>
<span class="n">system_dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="n">system_operator</span> <span class="o">=</span> <span class="n">displacement</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Define the time dependency of the system operator as a schedule that linearly</span>
<span class="c1"># increases the displacement parameter from 0 to 1.</span>
<span class="n">time_dependence</span> <span class="o">=</span> <span class="n">Schedule</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="p">[</span><span class="s1">&#39;displacement&#39;</span><span class="p">])</span>
<span class="n">initial_state</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span> <span class="o">/</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

<span class="c1"># Simulate the evolution of the system under this time dependent operator.</span>
<span class="n">cudaq</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">system_operator</span><span class="p">,</span> <span class="n">system_dimensions</span><span class="p">,</span> <span class="n">time_dependence</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--6-input--2" name="tab-set--6" type="radio"><label class="tab-label" for="tab-set--6-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c1">// Define a system consisting of a single degree of freedom (0) with</span>
<span class="w">    </span><span class="c1">// dimension 3.</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">dimension_map</span><span class="w"> </span><span class="n">system_dimensions</span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">}};</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">system_operator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">displacement</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Define the time dependency of the system operator as a schedule that</span>
<span class="w">    </span><span class="c1">// linearly increases the displacement parameter from 0 to 1.</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">schedule</span><span class="w"> </span><span class="nf">time_dependence</span><span class="p">(</span><span class="n">cudaq</span><span class="o">::</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">),</span>
<span class="w">                                    </span><span class="p">{</span><span class="s">&quot;displacement&quot;</span><span class="p">});</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">state_vec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">));</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">initial_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">state</span><span class="o">::</span><span class="n">from_data</span><span class="p">(</span><span class="n">state_vec</span><span class="p">);</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">integrators</span><span class="o">::</span><span class="n">runge_kutta</span><span class="w"> </span><span class="nf">integrator</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Simulate the evolution of the system under this time dependent operator.</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">evolve</span><span class="p">(</span><span class="n">system_operator</span><span class="p">,</span><span class="w"> </span><span class="n">system_dimensions</span><span class="p">,</span><span class="w"> </span><span class="n">time_dependence</span><span class="p">,</span>
<span class="w">                  </span><span class="n">initial_state</span><span class="p">,</span><span class="w"> </span><span class="n">integrator</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s say we want to add a squeezing term to the system operator. We can independently vary the squeezing
amplitude and the displacement amplitude by instantiating a schedule with a custom function that returns
the desired value for each parameter:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--7-input--1" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">system_operator</span> <span class="o">=</span> <span class="n">displacement</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">operators</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>


<span class="c1"># Define a schedule such that displacement amplitude increases linearly in time</span>
<span class="c1"># but the squeezing amplitude decreases, that is follows the inverse schedule.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">parameter_values</span><span class="p">(</span><span class="n">time_steps</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">compute_value</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span> <span class="n">step_idx</span><span class="p">):</span>
        <span class="k">match</span> <span class="n">param_name</span><span class="p">:</span>
            <span class="k">case</span> <span class="s1">&#39;displacement&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">time_steps</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">step_idx</span><span class="p">)]</span>
            <span class="k">case</span> <span class="s1">&#39;squeezing&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">time_steps</span><span class="p">[</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">step_idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>
            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;value for parameter </span><span class="si">{</span><span class="n">param_name</span><span class="si">}</span><span class="s2"> undefined&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">Schedule</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_steps</span><span class="p">)),</span> <span class="n">system_operator</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span>
                    <span class="n">compute_value</span><span class="p">)</span>


<span class="n">time_dependence</span> <span class="o">=</span> <span class="n">parameter_values</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">cudaq</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">system_operator</span><span class="p">,</span> <span class="n">system_dimensions</span><span class="p">,</span> <span class="n">time_dependence</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--7-input--2" name="tab-set--7" type="radio"><label class="tab-label" for="tab-set--7-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">displacement</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">matrix_op</span><span class="o">::</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Define a schedule such that displacement amplitude increases linearly in</span>
<span class="w">    </span><span class="c1">// time but the squeezing amplitude decreases, that is follows the inverse</span>
<span class="w">    </span><span class="c1">// schedule. def parameter_values(time_steps):</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">parameter_values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[](</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">time_steps</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">compute_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">time_steps</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">param_name</span><span class="p">,</span>
<span class="w">                                        </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">step</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">step_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">step</span><span class="p">.</span><span class="n">real</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">param_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;displacement&quot;</span><span class="p">)</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">time_steps</span><span class="p">[</span><span class="n">step_idx</span><span class="p">];</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">param_name</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;squeezing&quot;</span><span class="p">)</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="n">time_steps</span><span class="p">[</span><span class="n">time_steps</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">step_idx</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)];</span>

<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;value for parameter &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">param_name</span><span class="w"> </span><span class="o">+</span>
<span class="w">                                 </span><span class="s">&quot; undefined&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="p">};</span>

<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">steps</span><span class="p">;</span>
<span class="w">      </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">time_steps</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">        </span><span class="n">steps</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">schedule</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;displacement&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;squeezing&quot;</span><span class="p">},</span>
<span class="w">                             </span><span class="n">compute_value</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">time_dependence_param</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parameter_values</span><span class="p">(</span><span class="n">cudaq</span><span class="o">::</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">));</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">evolve</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span><span class="w"> </span><span class="n">system_dimensions</span><span class="p">,</span><span class="w"> </span><span class="n">time_dependence_param</span><span class="p">,</span>
<span class="w">                  </span><span class="n">initial_state</span><span class="p">,</span><span class="w"> </span><span class="n">integrator</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Compile and Run C++ program</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--8-input--1" name="tab-set--8" type="radio"><label class="tab-label" for="tab-set--8-input--1">C++</label><div class="tab-content docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nvq++<span class="w"> </span>--target<span class="w"> </span>dynamics<span class="w"> </span>dynamics.cpp<span class="w"> </span>-o<span class="w"> </span>dynamics<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>./dynamics
</pre></div>
</div>
</div>
</div>
</section>
<section id="super-operator-representation">
<h2>Super-operator Representation<a class="headerlink" href="#super-operator-representation" title="Permalink to this heading">¶</a></h2>
<p id="generic-rhs">In the previous examples, we assumed that the system dynamics is driven by a <code class="code docutils literal notranslate"><span class="pre">Lindblad</span></code> master equation, which is specified by the Hamiltonian operator and the collapse operators.</p>
<p>However, we may want to simulate an arbitrary state evolution equation, whereby the right-hand-side of the differential equation is provided as a generic super-operator.</p>
<p>CUDA-Q provides a <code class="code docutils literal notranslate"><span class="pre">SuperOperator</span></code> (Python) / <code class="code docutils literal notranslate"><span class="pre">super_op</span></code> (C++) class that can be used to represent the right-hand-side of the evolution equation. A super-operator can be constructed as a linear combination (sum) of left and/or right multiplication actions of <code class="code docutils literal notranslate"><span class="pre">Operator</span></code> instances.</p>
<p>As an example, we will look at specifying the Schrodinger’s equation <span class="math notranslate nohighlight">\(\frac{d|\Psi\rangle}{dt} = -i H |\Psi\rangle\)</span> as a super-operator.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--9-input--1" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cudaq</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cudaq</span><span class="w"> </span><span class="kn">import</span> <span class="n">spin</span><span class="p">,</span> <span class="n">Schedule</span><span class="p">,</span> <span class="n">RungeKuttaIntegrator</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">hamiltonian</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">spin</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="n">Schedule</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>
<span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="c1"># initial state</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">dynamics</span><span class="o">.</span><span class="n">InitialState</span><span class="o">.</span><span class="n">ZERO</span>
<span class="c1"># Create a super-operator that represents the evolution of the system</span>
<span class="c1"># under the Hamiltonian `-iH|psi&gt;`, where `H` is the Hamiltonian.</span>
<span class="n">se_super_op</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">SuperOperator</span><span class="p">()</span>
<span class="c1"># Apply `-iH|psi&gt;` super-operator</span>
<span class="n">se_super_op</span> <span class="o">+=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">SuperOperator</span><span class="o">.</span><span class="n">left_multiply</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">hamiltonian</span><span class="p">)</span>
<span class="n">evolution_result</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span><span class="n">se_super_op</span><span class="p">,</span>
                                <span class="n">dimensions</span><span class="p">,</span>
                                <span class="n">schedule</span><span class="p">,</span>
                                <span class="n">psi0</span><span class="p">,</span>
                                <span class="n">observables</span><span class="o">=</span><span class="p">[</span><span class="n">spin</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span>
                                <span class="n">store_intermediate_results</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">integrator</span><span class="o">=</span><span class="n">RungeKuttaIntegrator</span><span class="p">())</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--9-input--2" name="tab-set--9" type="radio"><label class="tab-label" for="tab-set--9-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">dimension_map</span><span class="w"> </span><span class="n">dims</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">}};</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">product_op</span><span class="o">&lt;</span><span class="n">cudaq</span><span class="o">::</span><span class="n">matrix_handler</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ham_</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">sum_op</span><span class="o">&lt;</span><span class="n">cudaq</span><span class="o">::</span><span class="n">matrix_handler</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ham</span><span class="p">(</span><span class="n">ham_</span><span class="p">);</span>
<span class="w">    </span><span class="k">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">numSteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">schedule</span><span class="w"> </span><span class="nf">schedule</span><span class="p">(</span><span class="n">cudaq</span><span class="o">::</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">numSteps</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;t&quot;</span><span class="p">});</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">initialState</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">cudaq</span><span class="o">::</span><span class="n">state</span><span class="o">::</span><span class="n">from_data</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="p">{</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">});</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">integrators</span><span class="o">::</span><span class="n">runge_kutta</span><span class="w"> </span><span class="nf">integrator</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.001</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Create a super-operator to evolve the system under the Schrödinger</span>
<span class="w">    </span><span class="c1">// equation `-iH * |psi&gt;`, where `H` is the Hamiltonian.</span>
<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">super_op</span><span class="w"> </span><span class="n">sup</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// Apply `-iH * |psi&gt;` superop</span>
<span class="w">    </span><span class="n">sup</span><span class="w"> </span><span class="o">+=</span>
<span class="w">        </span><span class="n">cudaq</span><span class="o">::</span><span class="n">super_op</span><span class="o">::</span><span class="n">left_multiply</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">-1.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ham</span><span class="p">);</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">evolve</span><span class="p">(</span><span class="n">sup</span><span class="p">,</span><span class="w"> </span><span class="n">dims</span><span class="p">,</span><span class="w"> </span><span class="n">schedule</span><span class="p">,</span><span class="w"> </span><span class="n">initialState</span><span class="p">,</span><span class="w"> </span><span class="n">integrator</span><span class="p">,</span>
<span class="w">                                </span><span class="p">{</span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)},</span>
<span class="w">                                </span><span class="n">cudaq</span><span class="o">::</span><span class="n">IntermediateResultSave</span><span class="o">::</span><span class="n">All</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>The super-operator, once constructed, can be used in the <code class="code docutils literal notranslate"><span class="pre">evolve</span></code> API instead of the Hamiltonian and collapse operators as shown in the above examples.</p>
</section>
<section id="numerical-integrators">
<h2>Numerical Integrators<a class="headerlink" href="#numerical-integrators" title="Permalink to this heading">¶</a></h2>
<p id="integrators">For Python, CUDA-Q provides a set of numerical integrators, to be used with the <code class="docutils literal notranslate"><span class="pre">dynamics</span></code>
backend target.</p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Numerical Integrators</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">RungeKuttaIntegrator</span></code></p></td>
<td><p>Explicit 4th-order Runge-Kutta method (default integrator)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">ScipyZvodeIntegrator</span></code></p></td>
<td><p>Complex-valued variable-coefficient ordinary differential equation solver (provided by SciPy)</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">CUDATorchDiffEqDopri5Integrator</span></code></p></td>
<td><p>Runge-Kutta of order 5 of Dormand-Prince-Shampine (provided by <code class="code docutils literal notranslate"><span class="pre">torchdiffeq</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">CUDATorchDiffEqAdaptiveHeunIntegrator</span></code></p></td>
<td><p>Runge-Kutta of order 2 (provided by <code class="code docutils literal notranslate"><span class="pre">torchdiffeq</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">CUDATorchDiffEqBosh3Integrator</span></code></p></td>
<td><p>Runge-Kutta of order 3 of Bogacki-Shampine (provided by <code class="code docutils literal notranslate"><span class="pre">torchdiffeq</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">CUDATorchDiffEqDopri8Integrator</span></code></p></td>
<td><p>Runge-Kutta of order 8 of Dormand-Prince-Shampine (provided by <code class="code docutils literal notranslate"><span class="pre">torchdiffeq</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">CUDATorchDiffEqEulerIntegrator</span></code></p></td>
<td><p>Euler method (provided by <code class="code docutils literal notranslate"><span class="pre">torchdiffeq</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">CUDATorchDiffEqExplicitAdamsIntegrator</span></code></p></td>
<td><p>Explicit Adams-Bashforth method (provided by <code class="code docutils literal notranslate"><span class="pre">torchdiffeq</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">CUDATorchDiffEqImplicitAdamsIntegrator</span></code></p></td>
<td><p>Implicit Adams-Bashforth-Moulton method (provided by <code class="code docutils literal notranslate"><span class="pre">torchdiffeq</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">CUDATorchDiffEqMidpointIntegrator</span></code></p></td>
<td><p>Midpoint method (provided by <code class="code docutils literal notranslate"><span class="pre">torchdiffeq</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">CUDATorchDiffEqRK4Integrator</span></code></p></td>
<td><p>Fourth-order Runge-Kutta with 3/8 rule (provided by <code class="code docutils literal notranslate"><span class="pre">torchdiffeq</span></code>)</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To use Torch-based integrators, users need to install <code class="code docutils literal notranslate"><span class="pre">torchdiffeq</span></code> (e.g., with <code class="code docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">torchdiffeq</span></code>).
This is an optional dependency of CUDA-Q, thus will not be installed by default.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using CUDA 12.8 on Blackwell, you may need to install nightly torch.</p>
<p>See <a class="reference internal" href="install/local_installation.html#blackwell-torch-dependences"><span class="std std-ref">Blackwell Torch Dependencies</span></a> for more information.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Torch-based integrators require a CUDA-enabled Torch installation. Depending on your platform (e.g., <code class="code docutils literal notranslate"><span class="pre">aarch64</span></code>),
the default Torch pip package may not have CUDA support.</p>
<p>The below command can be used to verify your installation:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import torch; print(torch.version.cuda)&quot;</span>
</pre></div>
</div>
<p>If the output is a ‘<code class="code docutils literal notranslate"><span class="pre">None</span></code>’ string, it indicates that your Torch installation does not support CUDA.
In this case, you need to install a CUDA-enabled Torch package via other mechanisms, e.g., building Torch from source or
using their Docker images.</p>
</div>
<p>For C++, CUDA-Q provides Runge-Kutta integrator, to be used with the <code class="docutils literal notranslate"><span class="pre">dynamics</span></code>
backend target.</p>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Numerical Integrators</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">runge_kutta</span></code></p></td>
<td><p>1st-order (Euler method), 2nd-order (Midpoint method), and 4th-order (classical Runge-Kutta method).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="batch-simulation">
<h2>Batch simulation<a class="headerlink" href="#batch-simulation" title="Permalink to this heading">¶</a></h2>
<p id="cudensitymat-batching">CUDA-Q <code class="docutils literal notranslate"><span class="pre">dynamics</span></code> target supports batch simulation, which allows users to run multiple simulations simultaneously.
This batching capability applies to (1) multiple initial states and/or (2) multiple Hamiltonians.</p>
<p>Batching can significantly improve performance when simulating many small identical system dynamics, e.g., parameter sweeping or tomography.</p>
<p>For example, we can simulate the time evolution of multiple initial states with the same Hamiltonian as follows:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--10-input--1" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cudaq</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cudaq</span><span class="w"> </span><span class="kn">import</span> <span class="n">spin</span><span class="p">,</span> <span class="n">Schedule</span><span class="p">,</span> <span class="n">RungeKuttaIntegrator</span>
<span class="c1"># Set the target to our dynamics simulator</span>
<span class="n">cudaq</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="s2">&quot;dynamics&quot;</span><span class="p">)</span>

<span class="c1"># Qubit Hamiltonian</span>
<span class="n">hamiltonian</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">spin</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Dimensions of sub-system. We only have a single degree of freedom of dimension 2 (two-level system).</span>
<span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="c1"># Initial states in the `SIC-POVM` set: https://en.wikipedia.org/wiki/SIC-POVM</span>
<span class="n">psi_1</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">complex128</span><span class="p">))</span>
<span class="n">psi_2</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">complex128</span><span class="p">))</span>
<span class="n">psi_3</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
    <span class="p">],</span>
             <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">complex128</span><span class="p">))</span>
<span class="n">psi_4</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span>
        <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span>
    <span class="p">],</span>
             <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">complex128</span><span class="p">))</span>

<span class="c1"># We run the evolution for all the SIC state to determine the process tomography.</span>
<span class="n">sic_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">psi_1</span><span class="p">,</span> <span class="n">psi_2</span><span class="p">,</span> <span class="n">psi_3</span><span class="p">,</span> <span class="n">psi_4</span><span class="p">]</span>
<span class="c1"># Schedule of time steps.</span>
<span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="n">Schedule</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">])</span>

<span class="c1"># Run the batch simulation.</span>
<span class="n">evolution_results</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="p">,</span>
    <span class="n">schedule</span><span class="p">,</span>
    <span class="n">sic_states</span><span class="p">,</span>
    <span class="n">observables</span><span class="o">=</span><span class="p">[</span><span class="n">spin</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">spin</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">spin</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span>
    <span class="n">collapse_operators</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">store_intermediate_results</span><span class="o">=</span><span class="n">cudaq</span><span class="o">.</span><span class="n">IntermediateResultSave</span><span class="o">.</span><span class="n">EXPECTATION_VALUE</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">RungeKuttaIntegrator</span><span class="p">())</span>

</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--10-input--2" name="tab-set--10" type="radio"><label class="tab-label" for="tab-set--10-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Qubit Hamiltonian</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">hamiltonian</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// A single qubit with dimension 2.</span>
<span class="w">  </span><span class="n">cudaq</span><span class="o">::</span><span class="n">dimension_map</span><span class="w"> </span><span class="n">dimensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">}};</span>

<span class="w">  </span><span class="c1">// Initial states in the `SIC-POVM` set:</span>
<span class="w">  </span><span class="c1">// https://en.wikipedia.org/wiki/SIC-POVM</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">psi_1</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">cudaq</span><span class="o">::</span><span class="n">state</span><span class="o">::</span><span class="n">from_data</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="p">{</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">});</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">psi_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">state</span><span class="o">::</span><span class="n">from_data</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="p">{</span>
<span class="w">      </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)});</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">psi_3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">state</span><span class="o">::</span><span class="n">from_data</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="p">{</span>
<span class="w">      </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">exp</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">{</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)});</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">psi_4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">state</span><span class="o">::</span><span class="n">from_data</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="p">{</span>
<span class="w">      </span><span class="mf">1.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">3.0</span><span class="p">),</span>
<span class="w">      </span><span class="n">std</span><span class="o">::</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span><span class="n">std</span><span class="o">::</span><span class="n">exp</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="p">{</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">1.0</span><span class="p">}</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">3.0</span><span class="p">)});</span>
<span class="w">  </span><span class="c1">// We run the evolution for all the SIC state to determine the process</span>
<span class="w">  </span><span class="c1">// tomography.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cudaq</span><span class="o">::</span><span class="n">state</span><span class="o">&gt;</span><span class="w"> </span><span class="n">sic_states</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">psi_1</span><span class="p">,</span><span class="w"> </span><span class="n">psi_2</span><span class="p">,</span><span class="w"> </span><span class="n">psi_3</span><span class="p">,</span><span class="w"> </span><span class="n">psi_4</span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Schedule of time steps.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">10.0</span><span class="p">,</span><span class="w"> </span><span class="mi">101</span><span class="p">);</span>
<span class="w">  </span><span class="n">cudaq</span><span class="o">::</span><span class="n">schedule</span><span class="w"> </span><span class="nf">schedule</span><span class="p">(</span><span class="n">steps</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// A default Runge-`Kutta` integrator</span>
<span class="w">  </span><span class="n">cudaq</span><span class="o">::</span><span class="n">integrators</span><span class="o">::</span><span class="n">runge_kutta</span><span class="w"> </span><span class="n">integrator</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Run the batch simulation.</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">evolve_results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">evolve</span><span class="p">(</span>
<span class="w">      </span><span class="n">hamiltonian</span><span class="p">,</span><span class="w"> </span><span class="n">dimensions</span><span class="p">,</span><span class="w"> </span><span class="n">schedule</span><span class="p">,</span><span class="w"> </span><span class="n">sic_states</span><span class="p">,</span><span class="w"> </span><span class="n">integrator</span><span class="p">,</span><span class="w"> </span><span class="p">{},</span>
<span class="w">      </span><span class="p">{</span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)},</span>
<span class="w">      </span><span class="n">cudaq</span><span class="o">::</span><span class="n">IntermediateResultSave</span><span class="o">::</span><span class="n">ExpectationValue</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Similarly, we can also batch simulate the time evolution of multiple Hamiltonians as follows:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--11-input--1" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cudaq</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cudaq</span><span class="w"> </span><span class="kn">import</span> <span class="n">spin</span><span class="p">,</span> <span class="n">Schedule</span><span class="p">,</span> <span class="n">ScalarOperator</span><span class="p">,</span> <span class="n">RungeKuttaIntegrator</span>
<span class="c1"># Set the target to our dynamics simulator</span>
<span class="n">cudaq</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="s2">&quot;dynamics&quot;</span><span class="p">)</span>

<span class="c1"># Dimensions of sub-system.</span>
<span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>

<span class="c1"># Qubit resonant frequency</span>
<span class="n">omega_z</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># Transverse term</span>
<span class="n">omega_x</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># Harmonic driving frequency (sweeping in the +/- 10% range around the resonant frequency).</span>
<span class="n">omega_drive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="n">omega_z</span><span class="p">,</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="n">omega_z</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>

<span class="c1"># Initial state of the system (ground state).</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">State</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">complex128</span><span class="p">))</span>

<span class="c1"># Batch the Hamiltonian operator together</span>
<span class="n">hamiltonians</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.5</span> <span class="o">*</span> <span class="n">omega_z</span> <span class="o">*</span> <span class="n">spin</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">omega_x</span> <span class="o">*</span>
    <span class="n">ScalarOperator</span><span class="p">(</span><span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">omega</span><span class="o">=</span><span class="n">omega</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">*</span> <span class="n">spin</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">omega</span> <span class="ow">in</span> <span class="n">omega_drive</span>
<span class="p">]</span>

<span class="c1"># Initial states for each Hamiltonian in the batch.</span>
<span class="c1"># Here, we use the ground state for all Hamiltonians.</span>
<span class="n">initial_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">psi0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">hamiltonians</span><span class="p">)</span>

<span class="c1"># Schedule of time steps.</span>
<span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
<span class="n">schedule</span> <span class="o">=</span> <span class="n">Schedule</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">])</span>

<span class="c1"># Run the batch simulation.</span>
<span class="n">evolution_results</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span>
    <span class="n">hamiltonians</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="p">,</span>
    <span class="n">schedule</span><span class="p">,</span>
    <span class="n">initial_states</span><span class="p">,</span>
    <span class="n">observables</span><span class="o">=</span><span class="p">[</span><span class="n">spin</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">spin</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">spin</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span>
    <span class="n">collapse_operators</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">store_intermediate_results</span><span class="o">=</span><span class="n">cudaq</span><span class="o">.</span><span class="n">IntermediateResultSave</span><span class="o">.</span><span class="n">EXPECTATION_VALUE</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">RungeKuttaIntegrator</span><span class="p">())</span>

</pre></div>
</div>
<p>In this example, we show the most generic batching capability, where each Hamiltonian in the batch corresponds to a specific initial state.
In other words, the vector of Hamiltonians and the vector of initial states are of the same length.
If only one initial state is provided, it will be used for all Hamiltonians in the batch.</p>
</div>
<input class="tab-input" id="tab-set--11-input--2" name="tab-set--11" type="radio"><label class="tab-label" for="tab-set--11-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Dimensions of sub-system</span>
<span class="w">  </span><span class="n">cudaq</span><span class="o">::</span><span class="n">dimension_map</span><span class="w"> </span><span class="n">dimensions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">}};</span>
<span class="w">  </span><span class="c1">// Qubit resonant frequency</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">omega_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">10.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Transverse driving term</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">omega_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">M_PI</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Harmonic driving frequency (sweeping in the +/- 10% range around the</span>
<span class="w">  </span><span class="c1">// resonant frequency).</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">omega_drive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.9</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">omega_z</span><span class="p">,</span><span class="w"> </span><span class="mf">1.1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">omega_z</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">zero_state</span><span class="w"> </span><span class="o">=</span>
<span class="w">      </span><span class="n">cudaq</span><span class="o">::</span><span class="n">state</span><span class="o">::</span><span class="n">from_data</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="p">{</span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="p">});</span>
<span class="w">  </span><span class="c1">// List of Hamiltonians to be batched together</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">&gt;</span><span class="w"> </span><span class="n">hamiltonians</span><span class="p">;</span>

<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">omega</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">omega_drive</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">mod_func</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="p">[</span><span class="n">omega</span><span class="p">](</span><span class="k">const</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">parameter_map</span><span class="w"> </span><span class="o">&amp;</span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">complex</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">auto</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">params</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;t&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">it</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">params</span><span class="p">.</span><span class="n">end</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">it</span><span class="o">-&gt;</span><span class="n">second</span><span class="p">.</span><span class="n">real</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;Cannot find the time parameter.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// Add the Hamiltonian for each drive frequency to the batch.</span>
<span class="w">    </span><span class="n">hamiltonians</span><span class="p">.</span><span class="n">emplace_back</span><span class="p">(</span><span class="mf">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">omega_z</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">                              </span><span class="n">mod_func</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">omega_x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// The qubit starts in the |0&gt; state for all operators in the batch.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">cudaq</span><span class="o">::</span><span class="n">state</span><span class="o">&gt;</span><span class="w"> </span><span class="n">initial_states</span><span class="p">(</span><span class="n">hamiltonians</span><span class="p">.</span><span class="n">size</span><span class="p">(),</span><span class="w"> </span><span class="n">zero_state</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// Schedule of time steps</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p">);</span>
<span class="w">  </span><span class="c1">// The schedule carries the time parameter `labelled` `t`, which is used by</span>
<span class="w">  </span><span class="c1">// the callback.</span>
<span class="w">  </span><span class="n">cudaq</span><span class="o">::</span><span class="n">schedule</span><span class="w"> </span><span class="n">schedule</span><span class="p">(</span><span class="n">steps</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;t&quot;</span><span class="p">});</span>

<span class="w">  </span><span class="c1">// A default Runge-`Kutta` integrator (4`th` order) with time step `dt`</span>
<span class="w">  </span><span class="c1">// depending on the schedule.</span>
<span class="w">  </span><span class="n">cudaq</span><span class="o">::</span><span class="n">integrators</span><span class="o">::</span><span class="n">runge_kutta</span><span class="w"> </span><span class="n">integrator</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Run the batch simulation.</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">evolve_results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">evolve</span><span class="p">(</span>
<span class="w">      </span><span class="n">hamiltonians</span><span class="p">,</span><span class="w"> </span><span class="n">dimensions</span><span class="p">,</span><span class="w"> </span><span class="n">schedule</span><span class="p">,</span><span class="w"> </span><span class="n">initial_states</span><span class="p">,</span><span class="w"> </span><span class="n">integrator</span><span class="p">,</span><span class="w"> </span><span class="p">{},</span>
<span class="w">      </span><span class="p">{</span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)},</span>
<span class="w">      </span><span class="n">cudaq</span><span class="o">::</span><span class="n">IntermediateResultSave</span><span class="o">::</span><span class="n">ExpectationValue</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>The results of the batch simulation will be returned as a list of evolve result objects, one for each Hamiltonian in the batch.
For example, we can extract the time evolution results of the expectation values for each Hamiltonian in the batch as follows:</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--12-input--1" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># The results of the batched evolution is an array of evolution results,</span>
<span class="c1"># one for each Hamiltonian operator in the batch.</span>

<span class="c1"># For example, we can split the results into separate arrays for each observable.</span>
<span class="n">all_exp_val_x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">all_exp_val_y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">all_exp_val_z</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># Iterate over the evolution results in the batch:</span>
<span class="k">for</span> <span class="n">evolution_result</span> <span class="ow">in</span> <span class="n">evolution_results</span><span class="p">:</span>
    <span class="c1"># Extract the expectation values for each observable at the respective Hamiltonian operator in the batch.</span>
    <span class="n">exp_val_x</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">exp_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">expectation</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">exp_vals</span> <span class="ow">in</span> <span class="n">evolution_result</span><span class="o">.</span><span class="n">expectation_values</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">exp_val_y</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">exp_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">expectation</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">exp_vals</span> <span class="ow">in</span> <span class="n">evolution_result</span><span class="o">.</span><span class="n">expectation_values</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="n">exp_val_z</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">exp_vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">expectation</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">exp_vals</span> <span class="ow">in</span> <span class="n">evolution_result</span><span class="o">.</span><span class="n">expectation_values</span><span class="p">()</span>
    <span class="p">]</span>

    <span class="c1"># Append the results to the respective lists.</span>
    <span class="c1"># These will be nested lists, where each inner list corresponds to the results for a specific Hamiltonian operator in the batch.</span>
    <span class="n">all_exp_val_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_val_x</span><span class="p">)</span>
    <span class="n">all_exp_val_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_val_y</span><span class="p">)</span>
    <span class="n">all_exp_val_z</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exp_val_z</span><span class="p">)</span>
</pre></div>
</div>
<p>The expectation values are returned as a list of lists, where each inner list corresponds to the expectation values for the observables at each time step for the respective Hamiltonian in the batch.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">all_exp_val_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span>...,<span class="w"> </span><span class="o">[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]]</span>
<span class="nv">all_exp_val_y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span>...,<span class="w"> </span><span class="o">[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]]</span>
<span class="nv">all_exp_val_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[[</span><span class="m">1</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">1</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span>...,<span class="w"> </span><span class="o">[</span><span class="m">1</span>.0,<span class="w"> </span>...<span class="o">]]</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--12-input--2" name="tab-set--12" type="radio"><label class="tab-label" for="tab-set--12-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// The results of the batched evolution is an array of evolution results, one</span>
<span class="w">  </span><span class="c1">// for each Hamiltonian operator in the batch.</span>

<span class="w">  </span><span class="c1">// For example, we can split the results into separate arrays for each</span>
<span class="w">  </span><span class="c1">// observable. These will be nested lists, where each inner list corresponds</span>
<span class="w">  </span><span class="c1">// to the results for a specific Hamiltonian operator in the batch.</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">all_exp_val_x</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">all_exp_val_y</span><span class="p">;</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">all_exp_val_z</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Iterate over the evolution results in the batch:</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">evolution_result</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">evolve_results</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Extract the expectation values for each observable at the respective</span>
<span class="w">    </span><span class="c1">// Hamiltonian operator in the batch.</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exp_val_x</span><span class="p">,</span><span class="w"> </span><span class="n">exp_val_y</span><span class="p">,</span><span class="w"> </span><span class="n">exp_val_z</span><span class="p">;</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="n">exp_vals</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">evolution_result</span><span class="p">.</span><span class="n">expectation_values</span><span class="p">.</span><span class="n">value</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">exp_val_x</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">exp_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">expectation</span><span class="p">());</span>
<span class="w">      </span><span class="n">exp_val_y</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">exp_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">expectation</span><span class="p">());</span>
<span class="w">      </span><span class="n">exp_val_z</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">exp_vals</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">expectation</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Append the results to the respective lists.</span>
<span class="w">    </span><span class="n">all_exp_val_x</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">exp_val_x</span><span class="p">);</span>
<span class="w">    </span><span class="n">all_exp_val_y</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">exp_val_y</span><span class="p">);</span>
<span class="w">    </span><span class="n">all_exp_val_z</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">exp_val_z</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
</pre></div>
</div>
<p>The expectation values are returned as a list of lists, where each inner list corresponds to the expectation values for the observables at each time step for the respective Hamiltonian in the batch.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">all_exp_val_x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span>...,<span class="w"> </span><span class="o">[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]]</span>
<span class="nv">all_exp_val_y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span>...,<span class="w"> </span><span class="o">[</span><span class="m">0</span>.0,<span class="w"> </span>...<span class="o">]]</span>
<span class="nv">all_exp_val_z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[[</span><span class="m">1</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span><span class="o">[</span><span class="m">1</span>.0,<span class="w"> </span>...<span class="o">]</span>,<span class="w"> </span>...,<span class="w"> </span><span class="o">[</span><span class="m">1</span>.0,<span class="w"> </span>...<span class="o">]]</span>
</pre></div>
</div>
</div>
</div>
<p>Collapse operators and super-operators can also be batched in a similar manner.
Specifically, if the <code class="code docutils literal notranslate"><span class="pre">collapse_operators</span></code> parameter is a nested list of operators (<span class="math notranslate nohighlight">\(\{\{L\}_1, \{\{L\}_2, ...\}\)</span>),
then each set of collapsed operators in the list will be applied to the corresponding Hamiltonian in the batch.</p>
<p>In order for all Hamiltonians to be batched, they must have the same structure, i.e., same number of product terms and those terms must act on the same degrees of freedom.
The order of the terms in the Hamiltonian does not matter, nor do the coefficient values/callback functions and the specific operators on those product terms.
Here are a couple of examples of Hamiltonians that can or cannot be batched:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>First Hamiltonian</p></th>
<th class="head"><p>Second Hamiltonian</p></th>
<th class="head"><p>Batchable?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(H_1 = \omega_1 \sigma_z(0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(H_2 = \omega_2 \sigma_z(0)\)</span></p></td>
<td><p>Yes (different coefficients, same operator)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(H_1 = \omega_z \sigma_z(0) + \cos(\omega_xt) \sigma_x(1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(H_2 = \omega_z \sigma_z(0) + \sin(\omega_xt)  \sigma_x(1)\)</span></p></td>
<td><p>Yes (same structure, different callback coefficients)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(H_1 = \omega_z \sigma_z(0) + \cos(\omega_xt) \sigma_x(1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(H_2 = \omega_z \sigma_z(0) + \cos(\omega_xt) \sigma_y(1)\)</span></p></td>
<td><p>Yes (different operators on the same degree of freedom)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(H_1 = \omega_z \sigma_z(0) + \cos(\omega_xt) \sigma_x(1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(H_2 = \omega_z \sigma_z(0) + \cos(\omega_xt) \sigma_x(1) + \cos(\omega_yt) \sigma_y(1)\)</span></p></td>
<td><p>No (different number of product terms)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(H_1 = \omega_z \sigma_z(0) + \cos(\omega_xt) \sigma_{xx}(0, 1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(H_2 = \omega_z \sigma_z(0) + \cos(\omega_xt) \sigma_x(0)\sigma_x(1)\)</span></p></td>
<td><p>No (different structures, two-body operators vs. tensor product of single-body operators)</p></td>
</tr>
</tbody>
</table>
<p>When the Hamiltonians are <strong>not</strong> <code class="code docutils literal notranslate"><span class="pre">batchable</span></code>, CUDA-Q will still run the simulations, but each Hamiltonian will be simulated separately in a sequential manner.
CUDA-Q will log a warning “The input Hamiltonian and collapse operators are not compatible for batching. Running the simulation in non-batched mode.”, when that happens.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Depending on the number of Hamiltonian operators together with factors such as the integrator, schedule step size, and whether intermediate results are stored, the batch simulation can be memory-intensive.
If you encounter out-of-memory issues, the <code class="code docutils literal notranslate"><span class="pre">max_batch_size</span></code> parameter can be used to limit the number of Hamiltonians that are batched together in one run.
For example, if you set <code class="code docutils literal notranslate"><span class="pre">max_batch_size=2</span></code>, then we will run the simulations in batches of 2 Hamiltonians at a time, i.e., the first two Hamiltonians will be simulated together, then the next two, and so on.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--13-input--1" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--1">Python</label><div class="tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the batch simulation with a maximum batch size of 2.</span>
<span class="c1"># This means that the evolution will be performed in batches of 2 Hamiltonian operators at a time, which can be useful for memory management or</span>
<span class="c1"># performance tuning.</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span>
    <span class="n">hamiltonians</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="p">,</span>
    <span class="n">schedule</span><span class="p">,</span>
    <span class="n">initial_states</span><span class="p">,</span>
    <span class="n">observables</span><span class="o">=</span><span class="p">[</span><span class="n">spin</span><span class="o">.</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">spin</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">spin</span><span class="o">.</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span>
    <span class="n">collapse_operators</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">store_intermediate_results</span><span class="o">=</span><span class="n">cudaq</span><span class="o">.</span><span class="n">IntermediateResultSave</span><span class="o">.</span><span class="n">EXPECTATION_VALUE</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">RungeKuttaIntegrator</span><span class="p">(),</span>
    <span class="n">max_batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Set the maximum batch size to 2</span>
</pre></div>
</div>
</div>
<input class="tab-input" id="tab-set--13-input--2" name="tab-set--13" type="radio"><label class="tab-label" for="tab-set--13-input--2">C++</label><div class="tab-content docutils">
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="c1">// Run the batch simulation with a maximum batch size of 2.</span>
<span class="w">  </span><span class="c1">// This means that the evolution will be performed in batches of 2 Hamiltonian</span>
<span class="w">  </span><span class="c1">// operators at a time, which can be useful for memory management or</span>
<span class="w">  </span><span class="c1">// performance tuning.</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">evolve</span><span class="p">(</span>
<span class="w">      </span><span class="n">hamiltonians</span><span class="p">,</span><span class="w"> </span><span class="n">dimensions</span><span class="p">,</span><span class="w"> </span><span class="n">schedule</span><span class="p">,</span><span class="w"> </span><span class="n">initial_states</span><span class="p">,</span><span class="w"> </span><span class="n">integrator</span><span class="p">,</span><span class="w"> </span><span class="p">{},</span>
<span class="w">      </span><span class="p">{</span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">x</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">spin_op</span><span class="o">::</span><span class="n">z</span><span class="p">(</span><span class="mi">0</span><span class="p">)},</span>
<span class="w">      </span><span class="n">cudaq</span><span class="o">::</span><span class="n">IntermediateResultSave</span><span class="o">::</span><span class="n">ExpectationValue</span><span class="p">,</span><span class="w"> </span><span class="cm">/*max_batch_size=*/</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="multi-gpu-multi-node-execution">
<h2>Multi-GPU Multi-Node Execution<a class="headerlink" href="#multi-gpu-multi-node-execution" title="Permalink to this heading">¶</a></h2>
<p id="cudensitymat-mgmn">CUDA-Q <code class="docutils literal notranslate"><span class="pre">dynamics</span></code> target supports parallel execution on multiple GPUs.
To enable parallel execution, the application must initialize MPI as follows.</p>
<div class="tab-set docutils">
<input checked="True" class="tab-input" id="tab-set--14-input--1" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--1">Python</label><div class="tab-content docutils">
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cudaq</span><span class="o">.</span><span class="n">mpi</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>

<span class="c1"># Set the target to our dynamics simulator</span>
<span class="n">cudaq</span><span class="o">.</span><span class="n">set_target</span><span class="p">(</span><span class="s2">&quot;dynamics&quot;</span><span class="p">)</span>

<span class="c1"># Initial state (expressed as an enum)</span>
<span class="n">psi0</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">dynamics</span><span class="o">.</span><span class="n">InitialState</span><span class="o">.</span><span class="n">ZERO</span>

<span class="c1"># Run the simulation</span>
<span class="n">evolution_result</span> <span class="o">=</span> <span class="n">cudaq</span><span class="o">.</span><span class="n">evolve</span><span class="p">(</span>
    <span class="n">H</span><span class="p">,</span>
    <span class="n">dimensions</span><span class="p">,</span>
    <span class="n">schedule</span><span class="p">,</span>
    <span class="n">psi0</span><span class="p">,</span>
    <span class="n">observables</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">collapse_operators</span><span class="o">=</span><span class="p">[],</span>
    <span class="n">store_intermediate_results</span><span class="o">=</span><span class="n">cudaq</span><span class="o">.</span><span class="n">IntermediateResultSave</span><span class="o">.</span><span class="n">NONE</span><span class="p">,</span>
    <span class="n">integrator</span><span class="o">=</span><span class="n">RungeKuttaIntegrator</span><span class="p">())</span>

<span class="n">cudaq</span><span class="o">.</span><span class="n">mpi</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpiexec<span class="w"> </span>-np<span class="w"> </span>&lt;N&gt;<span class="w"> </span>python3<span class="w"> </span>program.py
</pre></div>
</div>
</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of processes.</p>
</div>
<input class="tab-input" id="tab-set--14-input--2" name="tab-set--14" type="radio"><label class="tab-label" for="tab-set--14-input--2">C++</label><div class="tab-content docutils">
<blockquote>
<div><div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">mpi</span><span class="o">::</span><span class="n">initialize</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// Initial state (expressed as an enum)</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">psi0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cudaq</span><span class="o">::</span><span class="n">InitialState</span><span class="o">::</span><span class="n">ZERO</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Run the simulation</span>
<span class="w">    </span><span class="k">auto</span><span class="w"> </span><span class="n">evolution_result</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="n">cudaq</span><span class="o">::</span><span class="n">evolve</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="w"> </span><span class="n">dimensions</span><span class="p">,</span><span class="w"> </span><span class="n">schedule</span><span class="p">,</span><span class="w"> </span><span class="n">psi0</span><span class="p">,</span><span class="w"> </span><span class="n">integrator</span><span class="p">);</span>

<span class="w">    </span><span class="n">cudaq</span><span class="o">::</span><span class="n">mpi</span><span class="o">::</span><span class="n">finalize</span><span class="p">();</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nvq++<span class="w"> </span>--target<span class="w"> </span>dynamics<span class="w"> </span>example.cpp<span class="w"> </span>-o<span class="w"> </span>a.out
mpiexec<span class="w"> </span>-np<span class="w"> </span>&lt;N&gt;<span class="w"> </span>a.out
</pre></div>
</div>
</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of processes.</p>
</div>
</div>
<p>By initializing the MPI execution environment (via <code class="code docutils literal notranslate"><span class="pre">cudaq.mpi.initialize()</span></code>) in the application code and
invoking it via an MPI launcher, we have activated the multi-node multi-GPU feature of the <code class="docutils literal notranslate"><span class="pre">dynamics</span></code> target.
Specifically, it will detect the number of processes (GPUs) and distribute the computation across all available GPUs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of MPI processes must be a power of 2, one GPU per process.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not all integrators are capable of handling distributed state. Errors will be raised if parallel execution is activated
but the selected integrator does not support distributed state.</p>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">¶</a></h2>
<p>The <a class="reference internal" href="examples/dynamics_examples.html#dynamics-examples"><span class="std std-ref">Dynamics Examples</span></a> section of the docs contains a number of excellent dynamics examples demonstrating how to simulate basic physics models, specific qubit modalities, and utilize multi-GPU multi-Node capabilities.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="backends/cloud/nvqc.html" class="btn btn-neutral float-left" title="NVIDIA Quantum Cloud" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cudaqx/cudaqx.html" class="btn btn-neutral float-right" title="CUDA-QX" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, NVIDIA Corporation &amp; Affiliates.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>  

  <style>
  a:link, a:visited {
    color: #76b900;
  }

  a:hover {
    color: #8c0;
  }

  .rst-content dl:not(.docutils) dt {
    background: rgba(118, 185, 0, 0.1);
    color: rgba(59,93,0,1);
    border-top: solid 3px rgba(59,93,0,1);
  }
  </style>
  

</body>
</html>