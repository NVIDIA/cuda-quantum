{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "963fdca6",
   "metadata": {},
   "source": [
    "# Generating the electronic Hamiltonian\n",
    "\n",
    "For chemistry applications in quantum computing, one needs first to design the electronic Hamiltonian and convert it to qubit Hamiltonian. In this tutorial, we will explain how user can generate the electronic Hamiltonian for their subsequent quantum computing simulation.\n",
    "\n",
    "The electronic Hamiltonian describes the energy of electrons in the electrostatic field of nuclei that are assumed to be stationary with respect to an inertial frame [(1)](https://en.wikipedia.org/wiki/Molecular_Hamiltonian). This operator plays a central role in computational chemistry and physics for calculating properties of molecules including thermal conductivity, specific heat, electrical conductivity, optical properties, magnetic properties, and chemical reactivity.\n",
    "\n",
    "In quantum mechanics generally, the Hamiltonian operator represents the total energy of a system, including both kinetic and potential energy components. The electronic Hamiltonian specifically focuses on the electronic component of this energy within molecular systems.\n",
    "\n",
    "#### Second Quantized formulation.\n",
    "\n",
    "The second quantized formulation expresses the Hamiltonian in terms of creation and annihilation operators that automatically preserve the antisymmetry requirements for fermions. This representation is particularly useful for implementing computational methods in quantum chemistry.\n",
    "\n",
    "$$H = \\sum_{pq} h_{pq} a_p^\\dagger a_q + \\frac{1}{2} \\sum_{pqrs} g_{pqrs} a_p^\\dagger a_q^\\dagger a_r a_s$$\n",
    "\n",
    "where:\n",
    "- $h_{pq}$ are the one-electron integrals\n",
    "- $g_{pqrs}$ are the two-electron integrals\n",
    "- $a_p^\\dagger$ and $a_p$ are the fermion creation and annihilation operators\n",
    "\n",
    "This formulation provides significant advantages for computational implementations and development of electron correlation methods.\n",
    "\n",
    "### Computational Implementation\n",
    "\n",
    "The computational implementation of electronic Hamiltonians involves several key steps that transform the abstract operator into a concrete numerical representation.\n",
    "\n",
    "- Basis Set Expansion: The first step is to express the electronic Hamiltonian in a finite basis of atomic orbitals (AOs). These are typically Gaussian-type orbitals centered on atoms, chosen for computational efficiency\n",
    "- Integral Calculation: Once a basis is chosen, one-electron and two-electron integrals are computed in the AO basis. These represent matrix elements of the Hamiltonian components between different basis functions\n",
    "- Self-Consistent Field Calculation: A self-consistent field (SCF) procedure, typically using the Hartree-Fock method, is performed to obtain molecular orbitals (MOs) as linear combinations of AOs\n",
    "- Integral Transformation: The AO integrals are transformed to the MO basis using the coefficients from the SCF calculation. This transformation is computationally intensive but crucial for correlated methods\n",
    "- Spin Adaptation: For many applications, the spatial MO integrals are converted to spin MO integrals to account for electron spin explicitly\n",
    "\n",
    "In this tutorial, we employ [pyscf](https://github.com/pyscf/pyscf) to perform these calculations of electron integrals."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1c3a83f4",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Requires pyscf to be installed\n",
    "%pip install pyscf"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0a01426b",
   "metadata": {},
   "source": [
    "To calculate the electronic integrals, and generate the spin molecular Hamiltonian, import the following"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "0c795caa",
   "metadata": {},
   "outputs": [],
   "source": [
    "from qchem.classical_pyscf import get_mol_hamiltonian"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "95d5146c",
   "metadata": {},
   "source": [
    "To convert from fermionic Hamiltonian to qubit hamiltonian, import the following"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "a9df0323",
   "metadata": {},
   "outputs": [],
   "source": [
    "from qchem.hamiltonian import jordan_wigner_fermion"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "23ec3969",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import the cudaq module\n",
    "import cudaq\n",
    "\n",
    "# Set the traget\n",
    "# Double precision is recommended for the best performance.\n",
    "cudaq.set_target(\"nvidia\", option = \"fp64\")\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ef495ce0",
   "metadata": {},
   "source": [
    "#### (a) Generate the molecular Hamiltonian using Hartree Fock molecular orbitals"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "1ac10a7e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "overwrite output file: qchem/H2-pyscf.log\n",
      "[pyscf] Total number of orbitals =  2\n",
      "[pyscf] Total number of electrons =  2\n",
      "[pyscf] HF energy =  -1.1166512474115224\n",
      "[pyscf] Total R-CCSD energy =  -1.1372635051456805\n",
      "-------------------------------\n",
      "Molecular data\n",
      "-------------------------------\n",
      "Number of electrons:  2\n",
      "Total number of spatial orbitals:  2\n",
      "Number of spin molecular orbitals:  4\n",
      "Nuclear repulsion energy:  0.7131768341239892\n",
      "Fermionic hamiltonian:  -1.2521011771187975 a_0^dagger a_0 + -1.2521011771187975 b_0^dagger b_0 + 0.33718713635104147 a_0^dagger a_0^dagger a_0 a_0 + 0.33718713635104147 b_0^dagger b_0^dagger b_0 b_0 + 0.33718713635104147 a_0^dagger a_0^dagger b_0 b_0 + 0.33718713635104147 b_0^dagger b_0^dagger a_0 a_0 + 6.938893903907228e-18 a_0^dagger a_0^dagger a_0 a_1 + 6.938893903907228e-18 b_0^dagger b_0^dagger b_0 b_1 + 6.938893903907228e-18 a_0^dagger a_0^dagger b_0 b_1 + 6.938893903907228e-18 b_0^dagger b_0^dagger a_0 a_1 + 5.551115123125783e-17 a_0^dagger a_0^dagger a_1 a_0 + 5.551115123125783e-17 b_0^dagger b_0^dagger b_1 b_0 + 5.551115123125783e-17 a_0^dagger a_0^dagger b_1 b_0 + 5.551115123125783e-17 b_0^dagger b_0^dagger a_1 a_0 + 0.09066120278229657 a_0^dagger a_0^dagger a_1 a_1 + 0.09066120278229657 b_0^dagger b_0^dagger b_1 b_1 + 0.09066120278229657 a_0^dagger a_0^dagger b_1 b_1 + 0.09066120278229657 b_0^dagger b_0^dagger a_1 a_1 + 7.912018404978357e-17 a_0^dagger a_1 + 7.912018404978357e-17 b_0^dagger b_1 + -1.3877787807814457e-17 a_0^dagger a_1^dagger a_0 a_0 + -1.3877787807814457e-17 b_0^dagger b_1^dagger b_0 b_0 + -1.3877787807814457e-17 a_0^dagger a_1^dagger b_0 b_0 + -1.3877787807814457e-17 b_0^dagger b_1^dagger a_0 a_0 + 0.09066120278229672 a_0^dagger a_1^dagger a_0 a_1 + 0.09066120278229672 b_0^dagger b_1^dagger b_0 b_1 + 0.09066120278229672 a_0^dagger a_1^dagger b_0 b_1 + 0.09066120278229672 b_0^dagger b_1^dagger a_0 a_1 + 0.3316819374820622 a_0^dagger a_1^dagger a_1 a_0 + 0.3316819374820622 b_0^dagger b_1^dagger b_1 b_0 + 0.3316819374820622 a_0^dagger a_1^dagger b_1 b_0 + 0.3316819374820622 b_0^dagger b_1^dagger a_1 a_0 + 0.0 a_0^dagger a_1^dagger a_1 a_1 + 0.0 b_0^dagger b_1^dagger b_1 b_1 + 0.0 a_0^dagger a_1^dagger b_1 b_1 + 0.0 b_0^dagger b_1^dagger a_1 a_1 + 1.84737105656583e-16 a_1^dagger a_0 + 1.84737105656583e-16 b_1^dagger b_0 + 1.734723475976807e-17 a_1^dagger a_0^dagger a_0 a_0 + 1.734723475976807e-17 b_1^dagger b_0^dagger b_0 b_0 + 1.734723475976807e-17 a_1^dagger a_0^dagger b_0 b_0 + 1.734723475976807e-17 b_1^dagger b_0^dagger a_0 a_0 + 0.33168193748206226 a_1^dagger a_0^dagger a_0 a_1 + 0.33168193748206226 b_1^dagger b_0^dagger b_0 b_1 + 0.33168193748206226 a_1^dagger a_0^dagger b_0 b_1 + 0.33168193748206226 b_1^dagger b_0^dagger a_0 a_1 + 0.09066120278229656 a_1^dagger a_0^dagger a_1 a_0 + 0.09066120278229656 b_1^dagger b_0^dagger b_1 b_0 + 0.09066120278229656 a_1^dagger a_0^dagger b_1 b_0 + 0.09066120278229656 b_1^dagger b_0^dagger a_1 a_0 + 5.551115123125783e-17 a_1^dagger a_0^dagger a_1 a_1 + 5.551115123125783e-17 b_1^dagger b_0^dagger b_1 b_1 + 5.551115123125783e-17 a_1^dagger a_0^dagger b_1 b_1 + 5.551115123125783e-17 b_1^dagger b_0^dagger a_1 a_1 + -0.47632466628305836 a_1^dagger a_1 + -0.47632466628305836 b_1^dagger b_1 + 0.09066120278229671 a_1^dagger a_1^dagger a_0 a_0 + 0.09066120278229671 b_1^dagger b_1^dagger b_0 b_0 + 0.09066120278229671 a_1^dagger a_1^dagger b_0 b_0 + 0.09066120278229671 b_1^dagger b_1^dagger a_0 a_0 + 1.3877787807814457e-17 a_1^dagger a_1^dagger a_0 a_1 + 1.3877787807814457e-17 b_1^dagger b_1^dagger b_0 b_1 + 1.3877787807814457e-17 a_1^dagger a_1^dagger b_0 b_1 + 1.3877787807814457e-17 b_1^dagger b_1^dagger a_0 a_1 + 1.3877787807814457e-17 a_1^dagger a_1^dagger a_1 a_0 + 1.3877787807814457e-17 b_1^dagger b_1^dagger b_1 b_0 + 1.3877787807814457e-17 a_1^dagger a_1^dagger b_1 b_0 + 1.3877787807814457e-17 b_1^dagger b_1^dagger a_1 a_0 + 0.3486416866888513 a_1^dagger a_1^dagger a_1 a_1 + 0.3486416866888513 b_1^dagger b_1^dagger b_1 b_1 + 0.3486416866888513 a_1^dagger a_1^dagger b_1 b_1 + 0.3486416866888513 b_1^dagger b_1^dagger a_1 a_1\n",
      "-------------------------------\n",
      "Jordan-Wigner transformation\n",
      "-------------------------------\n",
      "[Cudaq] Qubit hamiltonian:  (-0.0996319+0i) + (0.171106+0i) * Z0 + (0.171106+0i) * Z1 + (-0.22251+0i) * Z2 + (-0.22251+0i) * Z3 + (0.168594+0i) * Z0Z1 + (0.12051+0i) * Z0Z2 + (0.165841+0i) * Z0Z3 + (0.165841+0i) * Z1Z2 + (0.12051+0i) * Z1Z3 + (0.174321+0i) * Z2Z3 + (-0.0453306+0i) * X0X1Y2Y3 + (0.0453306+0i) * X0Y1Y2X3 + (0.0453306+0i) * Y0X1X2Y3 + (-0.0453306+0i) * Y0Y1X2X3\n",
      "[Cudaq] Number of terms in the Qubit hamiltonian:  15\n"
     ]
    }
   ],
   "source": [
    "H2_mol = \"qchem/H2.xyz\"\n",
    "\n",
    "# Run HF, ccsd and compute the spin molecular hamiltonian using the HF molecular orbitals.\n",
    "molecular_data = get_mol_hamiltonian(xyz=H2_mol, spin=0, charge=0, basis='sto3g', ccsd=True, verbose=True)\n",
    "\n",
    "obi = molecular_data[0]\n",
    "tbi = molecular_data[1]\n",
    "e_nn = molecular_data[2]\n",
    "nelectrons = molecular_data[3]\n",
    "norbitals = molecular_data[4]\n",
    "fermionic_hamiltonian = molecular_data[5]\n",
    "\n",
    "print('-------------------------------')\n",
    "print('Molecular data')\n",
    "print('-------------------------------')\n",
    "print('Number of electrons: ', nelectrons)\n",
    "print('Total number of spatial orbitals: ', norbitals)\n",
    "print('Number of spin molecular orbitals: ', 2 * norbitals)\n",
    "print('Nuclear repulsion energy: ', e_nn)\n",
    "print('Fermionic hamiltonian: ', fermionic_hamiltonian)\n",
    "\n",
    "print('-------------------------------')\n",
    "print('Jordan-Wigner transformation')\n",
    "print('-------------------------------')\n",
    "# Compute the qubit hamiltonian.\n",
    "spin_ham = jordan_wigner_fermion(obi, tbi, e_nn, tolerance = 1e-12)\n",
    "\n",
    "print('[Cudaq] Qubit hamiltonian: ', spin_ham)\n",
    "print('[Cudaq] Number of terms in the Qubit hamiltonian: ', spin_ham.term_count)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1f04721d",
   "metadata": {},
   "source": [
    "### Active space Hamiltonian:\n",
    "\n",
    "The active space Hamiltonian [(2)](https://en.wikipedia.org/wiki/Complete_active_space) is a reduced-dimensionality quantum chemical model that focuses computational resources on the most chemically relevant orbitals and electrons. This approach enables practical calculations for systems with strong electron correlation by partitioning orbitals into three classes:\n",
    "\n",
    "- Core orbitals: Fully occupied and treated as inert\n",
    "- Active orbitals: Partially occupied, explicitly correlated\n",
    "- Virtual orbitals: Unoccupied and excluded\n",
    "\n",
    "The active space Hamiltonian $H^{AS}$ derives from the full electronic Hamiltonian through orbital space partitioning:\n",
    "\n",
    "$$H^{AS} = \\sum_{pq}^{\\text{active}} \\tilde{h}_{pq} \\hat{a}_p^{\\dagger} \\hat{a}_q + \\frac{1}{2} \\sum_{pqrs}^{\\text{active}} g_{pqrs} \\hat{a}_p^{\\dagger} \\hat{a}_q^{\\dagger} \\hat{a}_r \\hat{a}_s + E_{\\text{core}}$$\n",
    "\n",
    "Where:\n",
    "- $\\tilde{h}_{pq}$ are modified one-electron integrals incorporating mean-field effects from core orbitals\n",
    "- $g_{pqrs}$ are two-electron integrals within the active space\n",
    "- $E_{\\text{core}}$ accounts for frozen core contributions\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4d6ef665",
   "metadata": {},
   "source": [
    "#### (b) Generate the active space hamiltonian using HF molecular orbitals."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "de8309cc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "output file: qchem/H2O-pyscf.log\n",
      "[pyscf] Total number of orbitals =  13\n",
      "[pyscf] Total number of electrons =  10\n",
      "[pyscf] HF energy =  -75.983975537279\n",
      "[pyscf] R-CASCI energy using molecular orbitals=  -75.98508981028924\n",
      "[pyscf] R-CCSD energy of the active space using molecular orbitals=  -75.98508980454687\n",
      "-------------------------------\n",
      "Molecular data\n",
      "-------------------------------\n",
      "Number of electrons in the active space:  4\n",
      "Number of spatial orbitals in the active space:  4\n",
      "Number of spin molecular orbitals:  8\n",
      "Core energy:  -69.78937499839162\n",
      "-------------------------------\n",
      "Jordan-Wigner transformation\n",
      "-------------------------------\n",
      "[Cudaq] Qubit hamiltonian:  (-74.3886+0i) + (0.429698+0i) * Z0 + (0.429698+0i) * Z1 + (0.395076+0i) * Z2 + (0.395076+0i) * Z3 + (0.0246717+0i) * Z4 + (0.0246717+0i) * Z5 + (-0.0124873+0i) * Z6 + (-0.0124873+0i) * Z7 + (0.183927+0i) * Z0Z1 + (0.154956+0i) * Z0Z2 + (0.1664+0i) * Z0Z3 + (0.0441992+0i) * X0Z1Z2Z3X4 + (0.0441992+0i) * Y0Z1Z2Z3Y4 + (0.0835026+0i) * Z0Z4 + (0.0902279+0i) * Z0Z5 + (0.0881962+0i) * Z0Z6 + (0.0939854+0i) * Z0Z7 + (0.1664+0i) * Z1Z2 + (0.154956+0i) * Z1Z3 + (0.0902279+0i) * Z1Z4 + (0.0441992+0i) * X1Z2Z3Z4X5 + (0.0441992+0i) * Y1Z2Z3Z4Y5 + (0.0835026+0i) * Z1Z5 + (0.0939854+0i) * Z1Z6 + (0.0881962+0i) * Z1Z7 + (0.190993+0i) * Z2Z3 + (0.089279+0i) * Z2Z4 + (0.0924599+0i) * Z2Z5 + (0.0920865+0i) * Z2Z6 + (0.0941389+0i) * Z2Z7 + (0.0924599+0i) * Z3Z4 + (0.089279+0i) * Z3Z5 + (0.0941389+0i) * Z3Z6 + (0.0920865+0i) * Z3Z7 + (0.0843783+0i) * Z4Z5 + (0.061204+0i) * Z4Z6 + (0.0833701+0i) * Z4Z7 + (0.0833701+0i) * Z5Z6 + (0.061204+0i) * Z5Z7 + (0.0864277+0i) * Z6Z7 + (0.0184753+0i) * Z0X1Z2Z3Z4X5 + (0.0184753+0i) * Z0Y1Z2Z3Z4Y5 + (0.0184753+0i) * X0Z2Z3X4 + (0.0184753+0i) * Y0Z2Z3Y4 + (-0.0114445+0i) * X0X1Y2Y3 + (0.0114445+0i) * X0Y1Y2X3 + (0.0114445+0i) * Y0X1X2Y3 + (-0.0114445+0i) * Y0Y1X2X3 + (-0.00672531+0i) * X0X1Y4Y5 + (0.00672531+0i) * X0Y1Y4X5 + (0.00672531+0i) * Y0X1X4Y5 + (-0.00672531+0i) * Y0Y1X4X5 + (-0.00578919+0i) * X0X1Y6Y7 + (0.00578919+0i) * X0Y1Y6X7 + (0.00578919+0i) * Y0X1X6Y7 + (-0.00578919+0i) * Y0Y1X6X7 + (0.01658+0i) * X0Z1Z3X4 + (0.01658+0i) * Y0Z1Z3Y4 + (-8.79249e-05+0i) * X0Z1X2X3Z4X5 + (-8.79249e-05+0i) * X0Z1X2Y3Z4Y5 + (-8.79249e-05+0i) * Y0Z1Y2X3Z4X5 + (-8.79249e-05+0i) * Y0Z1Y2Y3Z4Y5 + (0.0166679+0i) * X0Z1Z2X4 + (0.0166679+0i) * Y0Z1Z2Y4 + (0.000423558+0i) * X0Z1Z2Z3X4Z5 + (0.000423558+0i) * Y0Z1Z2Z3Y4Z5 + (-0.00705531+0i) * X0Z1Z2Z3Z4X5Y6Y7 + (0.00705531+0i) * X0Z1Z2Z3Z4Y5Y6X7 + (0.00705531+0i) * Y0Z1Z2Z3Z4X5X6Y7 + (-0.00705531+0i) * Y0Z1Z2Z3Z4Y5X6X7 + (0.00707794+0i) * X0Z1Z2Z3X4Z6 + (0.00707794+0i) * Y0Z1Z2Z3Y4Z6 + (2.26249e-05+0i) * X0Z1Z2Z3X4Z7 + (2.26249e-05+0i) * Y0Z1Z2Z3Y4Z7 + (0.0166679+0i) * X1Z3Z4X5 + (0.0166679+0i) * Y1Z3Z4Y5 + (8.79249e-05+0i) * X1X2Y3Y4 + (-8.79249e-05+0i) * X1Y2Y3X4 + (-8.79249e-05+0i) * Y1X2X3Y4 + (8.79249e-05+0i) * Y1Y2X3X4 + (0.01658+0i) * X1Z2Z4X5 + (0.01658+0i) * Y1Z2Z4Y5 + (0.000423558+0i) * X1Z2Z3X5 + (0.000423558+0i) * Y1Z2Z3Y5 + (-0.00705531+0i) * X1Z2Z3X4X6X7 + (-0.00705531+0i) * X1Z2Z3Y4Y6X7 + (-0.00705531+0i) * Y1Z2Z3X4X6Y7 + (-0.00705531+0i) * Y1Z2Z3Y4Y6Y7 + (2.26249e-05+0i) * X1Z2Z3Z4X5Z6 + (2.26249e-05+0i) * Y1Z2Z3Z4Y5Z6 + (0.00707794+0i) * X1Z2Z3Z4X5Z7 + (0.00707794+0i) * Y1Z2Z3Z4Y5Z7 + (-0.00318093+0i) * X2X3Y4Y5 + (0.00318093+0i) * X2Y3Y4X5 + (0.00318093+0i) * Y2X3X4Y5 + (-0.00318093+0i) * Y2Y3X4X5 + (-0.00205243+0i) * X2X3Y6Y7 + (0.00205243+0i) * X2Y3Y6X7 + (0.00205243+0i) * Y2X3X6Y7 + (-0.00205243+0i) * Y2Y3X6X7 + (-0.0221661+0i) * X4X5Y6Y7 + (0.0221661+0i) * X4Y5Y6X7 + (0.0221661+0i) * Y4X5X6Y7 + (-0.0221661+0i) * Y4Y5X6X7\n",
      "[Cudaq] Number of terms in the Qubit hamiltonian:  105\n"
     ]
    }
   ],
   "source": [
    "H2O_mol = \"qchem/H2O.xyz\"\n",
    "\n",
    "# Run HF, ccsd, casci and compute the active space spin molecular hamiltonian\n",
    "# using the HF molecular orbitals with 4 electron and 4 orbitals in the active space.\n",
    "molecular_data = get_mol_hamiltonian(xyz=H2O_mol, spin=0, charge=0, basis='631g', nele_cas=4, norb_cas=4, \n",
    "                                     ccsd=True, casci=True, verbose=True)\n",
    "\n",
    "obi = molecular_data[0]\n",
    "tbi = molecular_data[1]\n",
    "ecore = molecular_data[2]\n",
    "nelectrons = molecular_data[3]\n",
    "norbitals = molecular_data[4]\n",
    "fermionic_hamiltonian = molecular_data[5]\n",
    "\n",
    "print('-------------------------------')\n",
    "print('Molecular data')\n",
    "print('-------------------------------')\n",
    "print('Number of electrons in the active space: ', nelectrons)\n",
    "print('Number of spatial orbitals in the active space: ', norbitals)\n",
    "print('Number of spin molecular orbitals: ', 2 * norbitals)\n",
    "print('Core energy: ', ecore)\n",
    "#print('Fermionic hamiltonian: ', fermionic_hamiltonian)\n",
    "\n",
    "print('-------------------------------')\n",
    "print('Jordan-Wigner transformation')\n",
    "print('-------------------------------')\n",
    "# Compute the qubit hamiltonian.\n",
    "spin_ham = jordan_wigner_fermion(obi, tbi, ecore)\n",
    "print('[Cudaq] Qubit hamiltonian: ', spin_ham)\n",
    "print('[Cudaq] Number of terms in the Qubit hamiltonian: ', spin_ham.term_count)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b382bd22",
   "metadata": {},
   "source": [
    "#### (c) Generate the active space Hamiltonian using the natural orbitals computed from MP2 simulation "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "2a8cdb09",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "overwrite output file: qchem/H2O-pyscf.log\n",
      "[pyscf] Total number of orbitals =  13\n",
      "[pyscf] Total number of electrons =  10\n",
      "[pyscf] HF energy =  -75.98397553727892\n",
      "[pyscf] R-MP2 energy=  -76.1128067006504\n",
      "[pyscf] Natural orbital occupation number from R-MP2: \n",
      "[1.99995663e+00 1.99012740e+00 1.98197049e+00 1.97722983e+00\n",
      " 1.97515174e+00 2.23585706e-02 2.09527832e-02 1.73621504e-02\n",
      " 1.00838241e-02 2.32351484e-03 1.74875097e-03 4.27482714e-04\n",
      " 3.06831462e-04]\n",
      "[pyscf] R-CASCI energy using natural orbitals=  -76.03304212600104\n",
      "[pyscf] R-CCSD energy of the active space using natural orbitals=  -76.03293564805286\n",
      "-------------------------------\n",
      "Molecular data\n",
      "-------------------------------\n",
      "Number of electrons in the active space:  4\n",
      "Number of spatial orbitals in the active space:  4\n",
      "Number of spin molecular orbitals:  8\n",
      "Core energy:  -69.59209064077999\n",
      "-------------------------------\n",
      "Jordan-Wigner transformation\n",
      "-------------------------------\n",
      "[Cudaq] Qubit hamiltonian:  (-73.4465+0i) + (0.19855+0i) * Z0 + (0.19855+0i) * Z1 + (0.233578+0i) * Z2 + (0.233578+0i) * Z3 + (-0.284531+0i) * Z4 + (-0.284531+0i) * Z5 + (-0.317727+0i) * Z6 + (-0.317727+0i) * Z7 + (0.169845+0i) * Z0Z1 + (0.137855+0i) * Z0Z2 + (0.153384+0i) * Z0Z3 + (0.145992+0i) * Z0Z4 + (0.156607+0i) * Z0Z5 + (0.018065+0i) * X0Z1Z2Z3Z4Z5X6 + (0.018065+0i) * Y0Z1Z2Z3Z4Z5Y6 + (0.123378+0i) * Z0Z6 + (0.164004+0i) * Z0Z7 + (0.153384+0i) * Z1Z2 + (0.137855+0i) * Z1Z3 + (0.156607+0i) * Z1Z4 + (0.145992+0i) * Z1Z5 + (0.164004+0i) * Z1Z6 + (0.018065+0i) * X1Z2Z3Z4Z5Z6X7 + (0.018065+0i) * Y1Z2Z3Z4Z5Z6Y7 + (0.123378+0i) * Z1Z7 + (0.163223+0i) * Z2Z3 + (0.00966883+0i) * X2Z3X4 + (0.00966883+0i) * Y2Z3Y4 + (0.119937+0i) * Z2Z4 + (0.163499+0i) * Z2Z5 + (0.140568+0i) * Z2Z6 + (0.151859+0i) * Z2Z7 + (0.163499+0i) * Z3Z4 + (0.00966883+0i) * X3Z4X5 + (0.00966883+0i) * Y3Z4Y5 + (0.119937+0i) * Z3Z5 + (0.151859+0i) * Z3Z6 + (0.140568+0i) * Z3Z7 + (0.175043+0i) * Z4Z5 + (0.141038+0i) * Z4Z6 + (0.159822+0i) * Z4Z7 + (0.159822+0i) * Z5Z6 + (0.141038+0i) * Z5Z7 + (0.170651+0i) * Z6Z7 + (-0.042603+0i) * Z0X1Z2Z3Z4Z5Z6X7 + (-0.042603+0i) * Z0Y1Z2Z3Z4Z5Z6Y7 + (-0.042603+0i) * X0Z2Z3Z4Z5X6 + (-0.042603+0i) * Y0Z2Z3Z4Z5Y6 + (-0.0155289+0i) * X0X1Y2Y3 + (0.0155289+0i) * X0Y1Y2X3 + (0.0155289+0i) * Y0X1X2Y3 + (-0.0155289+0i) * Y0Y1X2X3 + (0.00424669+0i) * X0X1Y2Z3Z4Y5 + (-0.00424669+0i) * X0Y1Y2Z3Z4X5 + (-0.00424669+0i) * Y0X1X2Z3Z4Y5 + (0.00424669+0i) * Y0Y1X2Z3Z4X5 + (0.00424669+0i) * X0X1X3X4 + (0.00424669+0i) * X0Y1Y3X4 + (0.00424669+0i) * Y0X1X3Y4 + (0.00424669+0i) * Y0Y1Y3Y4 + (-0.0106147+0i) * X0X1Y4Y5 + (0.0106147+0i) * X0Y1Y4X5 + (0.0106147+0i) * Y0X1X4Y5 + (-0.0106147+0i) * Y0Y1X4X5 + (-0.0406258+0i) * X0X1Y6Y7 + (0.0406258+0i) * X0Y1Y6X7 + (0.0406258+0i) * Y0X1X6Y7 + (-0.0406258+0i) * Y0Y1X6X7 + (-0.0382825+0i) * Z0X2Z3X4 + (-0.0382825+0i) * Z0Y2Z3Y4 + (-0.0355881+0i) * X0Z1Z3Z4Z5X6 + (-0.0355881+0i) * Y0Z1Z3Z4Z5Y6 + (-0.0184957+0i) * X0Z1X2X4Z5X6 + (0.00516964+0i) * X0Z1X2Y4Z5Y6 + (-0.0236653+0i) * X0Z1Y2Y4Z5X6 + (-0.0236653+0i) * Y0Z1X2X4Z5Y6 + (0.00516964+0i) * Y0Z1Y2X4Z5X6 + (-0.0184957+0i) * Y0Z1Y2Y4Z5Y6 + (-0.0340358+0i) * Z0X3Z4X5 + (-0.0340358+0i) * Z0Y3Z4Y5 + (-0.00538795+0i) * X0Z1X2X3Z4Z5Z6X7 + (-0.00538795+0i) * X0Z1X2Y3Z4Z5Z6Y7 + (-0.00538795+0i) * Y0Z1Y2X3Z4Z5Z6X7 + (-0.00538795+0i) * Y0Z1Y2Y3Z4Z5Z6Y7 + (-0.0302001+0i) * X0Z1Z2Z4Z5X6 + (-0.0302001+0i) * Y0Z1Z2Z4Z5Y6 + (-0.0102326+0i) * X0Z1Z2X3Y4Z5Z6Y7 + (0.0102326+0i) * X0Z1Z2Y3Y4Z5Z6X7 + (0.0102326+0i) * Y0Z1Z2X3X4Z5Z6Y7 + (-0.0102326+0i) * Y0Z1Z2Y3X4Z5Z6X7 + (-0.0338979+0i) * X0Z1Z2X3X5X6 + (-0.0338979+0i) * X0Z1Z2Y3Y5X6 + (-0.0338979+0i) * Y0Z1Z2X3X5Y6 + (-0.0338979+0i) * Y0Z1Z2Y3Y5Y6 + (-0.0439322+0i) * X0Z1Z2Z3Z5X6 + (-0.0439322+0i) * Y0Z1Z2Z3Z5Y6 + (0.0154022+0i) * X0Z1X2X5Z6X7 + (0.0154022+0i) * X0Z1X2Y5Z6Y7 + (0.0154022+0i) * Y0Z1Y2X5Z6X7 + (0.0154022+0i) * Y0Z1Y2Y5Z6Y7 + (-0.00600788+0i) * X0Z1Z2Z3X4X5Z6X7 + (-0.00600788+0i) * X0Z1Z2Z3X4Y5Z6Y7 + (-0.00600788+0i) * Y0Z1Z2Z3Y4X5Z6X7 + (-0.00600788+0i) * Y0Z1Z2Z3Y4Y5Z6Y7 + (-0.0379243+0i) * X0Z1Z2Z3Z4X6 + (-0.0379243+0i) * Y0Z1Z2Z3Z4Y6 + (-0.0445998+0i) * X0Z1Z2Z3Z4Z5X6Z7 + (-0.0445998+0i) * Y0Z1Z2Z3Z4Z5Y6Z7 + (-0.0340358+0i) * Z1X2Z3X4 + (-0.0340358+0i) * Z1Y2Z3Y4 + (-0.0302001+0i) * X1Z3Z4Z5Z6X7 + (-0.0302001+0i) * Y1Z3Z4Z5Z6Y7 + (0.00538795+0i) * X1X2Y3Z4Z5Y6 + (-0.00538795+0i) * X1Y2Y3Z4Z5X6 + (-0.00538795+0i) * Y1X2X3Z4Z5Y6 + (0.00538795+0i) * Y1Y2X3Z4Z5X6 + (-0.0338979+0i) * X1X2X4Z5Z6X7 + (-0.0338979+0i) * X1Y2Y4Z5Z6X7 + (-0.0338979+0i) * Y1X2X4Z5Z6Y7 + (-0.0338979+0i) * Y1Y2Y4Z5Z6Y7 + (-0.0102326+0i) * X1X2Y5Y6 + (0.0102326+0i) * X1Y2Y5X6 + (0.0102326+0i) * Y1X2X5Y6 + (-0.0102326+0i) * Y1Y2X5X6 + (-0.0382825+0i) * Z1X3Z4X5 + (-0.0382825+0i) * Z1Y3Z4Y5 + (-0.0355881+0i) * X1Z2Z4Z5Z6X7 + (-0.0355881+0i) * Y1Z2Z4Z5Z6Y7 + (-0.0184957+0i) * X1Z2X3X5Z6X7 + (0.00516964+0i) * X1Z2X3Y5Z6Y7 + (-0.0236653+0i) * X1Z2Y3Y5Z6X7 + (-0.0236653+0i) * Y1Z2X3X5Z6Y7 + (0.00516964+0i) * Y1Z2Y3X5Z6X7 + (-0.0184957+0i) * Y1Z2Y3Y5Z6Y7 + (0.0154022+0i) * X1Z2X3X4Z5X6 + (0.0154022+0i) * X1Z2X3Y4Z5Y6 + (0.0154022+0i) * Y1Z2Y3X4Z5X6 + (0.0154022+0i) * Y1Z2Y3Y4Z5Y6 + (-0.0379243+0i) * X1Z2Z3Z5Z6X7 + (-0.0379243+0i) * Y1Z2Z3Z5Z6Y7 + (0.00600788+0i) * X1Z2Z3X4Y5Y6 + (-0.00600788+0i) * X1Z2Z3Y4Y5X6 + (-0.00600788+0i) * Y1Z2Z3X4X5Y6 + (0.00600788+0i) * Y1Z2Z3Y4X5X6 + (-0.0439322+0i) * X1Z2Z3Z4Z6X7 + (-0.0439322+0i) * Y1Z2Z3Z4Z6Y7 + (-0.0445998+0i) * X1Z2Z3Z4Z5X7 + (-0.0445998+0i) * Y1Z2Z3Z4Z5Y7 + (-0.0327198+0i) * Z2X3Z4X5 + (-0.0327198+0i) * Z2Y3Z4Y5 + (-0.0327198+0i) * X2X4 + (-0.0327198+0i) * Y2Y4 + (-0.0435622+0i) * X2X3Y4Y5 + (0.0435622+0i) * X2Y3Y4X5 + (0.0435622+0i) * Y2X3X4Y5 + (-0.0435622+0i) * Y2Y3X4X5 + (-0.0112912+0i) * X2X3Y6Y7 + (0.0112912+0i) * X2Y3Y6X7 + (0.0112912+0i) * Y2X3X6Y7 + (-0.0112912+0i) * Y2Y3X6X7 + (-0.0425308+0i) * X2Z3X4Z5 + (-0.0425308+0i) * Y2Z3Y4Z5 + (0.00684156+0i) * X2Z3Z4X5Y6Y7 + (-0.00684156+0i) * X2Z3Z4Y5Y6X7 + (-0.00684156+0i) * Y2Z3Z4X5X6Y7 + (0.00684156+0i) * Y2Z3Z4Y5X6X7 + (-0.0395088+0i) * X2Z3X4Z6 + (-0.0395088+0i) * Y2Z3Y4Z6 + (-0.0326672+0i) * X2Z3X4Z7 + (-0.0326672+0i) * Y2Z3Y4Z7 + (-0.0425308+0i) * X3X5 + (-0.0425308+0i) * Y3Y5 + (0.00684156+0i) * X3X4X6X7 + (0.00684156+0i) * X3Y4Y6X7 + (0.00684156+0i) * Y3X4X6Y7 + (0.00684156+0i) * Y3Y4Y6Y7 + (-0.0326672+0i) * X3Z4X5Z6 + (-0.0326672+0i) * Y3Z4Y5Z6 + (-0.0395088+0i) * X3Z4X5Z7 + (-0.0395088+0i) * Y3Z4Y5Z7 + (-0.0187841+0i) * X4X5Y6Y7 + (0.0187841+0i) * X4Y5Y6X7 + (0.0187841+0i) * Y4X5X6Y7 + (-0.0187841+0i) * Y4Y5X6X7\n",
      "[Cudaq] Number of terms in the Qubit hamiltonian:  185\n"
     ]
    }
   ],
   "source": [
    "H2O_mol = \"qchem/H2O.xyz\"\n",
    "\n",
    "# Run HF, MP2, ccsd, casci and compute the active space spin molecular hamiltonian.\n",
    "# Inspect the active space from the natural orbitals. Natural orbitals are computed using MP2. \n",
    "# The active space is defined by 4 electrons and 4 orbitals.\n",
    "# The natural orbitals are used to compute the electron integrals.\n",
    "molecular_data = get_mol_hamiltonian(xyz=H2O_mol, spin=0, charge=0, basis='631g',nele_cas=4, norb_cas=4, \n",
    "                                     MP2=True, natorb=True, ccsd=True, casci=True, integrals_natorb=True, verbose=True)\n",
    "\n",
    "obi = molecular_data[0]\n",
    "tbi = molecular_data[1]\n",
    "ecore = molecular_data[2]\n",
    "nelectrons = molecular_data[3]\n",
    "norbitals = molecular_data[4]\n",
    "fermionic_hamiltonian = molecular_data[5]\n",
    "\n",
    "print('-------------------------------')\n",
    "print('Molecular data')\n",
    "print('-------------------------------')\n",
    "print('Number of electrons in the active space: ', nelectrons)\n",
    "print('Number of spatial orbitals in the active space: ', norbitals)\n",
    "print('Number of spin molecular orbitals: ', 2 * norbitals)\n",
    "print('Core energy: ', ecore)\n",
    "#print('Fermionic hamiltonian: ', fermionic_hamiltonian)\n",
    "\n",
    "print('-------------------------------')\n",
    "print('Jordan-Wigner transformation')\n",
    "print('-------------------------------')\n",
    "# Compute the qubit hamiltonian.\n",
    "spin_ham = jordan_wigner_fermion(obi, tbi, ecore)\n",
    "print('[Cudaq] Qubit hamiltonian: ', spin_ham)\n",
    "print('[Cudaq] Number of terms in the Qubit hamiltonian: ', spin_ham.term_count)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aa3ce84f",
   "metadata": {},
   "source": [
    "#### (d) Generate the active space Hamiltonian computed from the CASSCF molecular orbitals"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "d2728947",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "overwrite output file: qchem/H2O-pyscf.log\n",
      "[pyscf] Total number of orbitals =  13\n",
      "[pyscf] Total number of electrons =  10\n",
      "[pyscf] HF energy =  -75.98397553727888\n",
      "[pyscf] R-MP2 energy=  -76.11280670065035\n",
      "[pyscf] Natural orbital occupation number from R-MP2: \n",
      "[1.99995663e+00 1.99012740e+00 1.98197049e+00 1.97722983e+00\n",
      " 1.97515174e+00 2.23585706e-02 2.09527832e-02 1.73621504e-02\n",
      " 1.00838241e-02 2.32351484e-03 1.74875097e-03 4.27482714e-04\n",
      " 3.06831462e-04]\n",
      "[pyscf] R-CASSCF energy using natural orbitals=  -76.03702384069331\n",
      "-------------------------------\n",
      "Molecular data\n",
      "-------------------------------\n",
      "Number of electrons in the active space:  4\n",
      "Number of spatial orbitals in the active space:  4\n",
      "Number of spin molecular orbitals:  8\n",
      "Core energy:  -69.148108185141\n",
      "-------------------------------\n",
      "Jordan-Wigner transformation\n",
      "-------------------------------\n",
      "[Cudaq] Qubit hamiltonian:  (-73.4246+0i) + (0.286+0i) * Z0 + (0.286+0i) * Z1 + (0.232955+0i) * Z2 + (0.232955+0i) * Z3 + (-0.262533+0i) * Z4 + (-0.262533+0i) * Z5 + (-0.24543+0i) * Z6 + (-0.24543+0i) * Z7 + (0.181709+0i) * Z0Z1 + (4.19845e-10+0i) * X0Z1X2 + (4.19845e-10+0i) * Y0Z1Y2 + (0.135721+0i) * Z0Z2 + (0.158846+0i) * Z0Z3 + (3.54559e-11+0i) * X0Z1Z2Z3X4 + (3.54559e-11+0i) * Y0Z1Z2Z3Y4 + (0.147141+0i) * Z0Z4 + (0.159353+0i) * Z0Z5 + (0.00801359+0i) * X0Z1Z2Z3Z4Z5X6 + (0.00801359+0i) * Y0Z1Z2Z3Z4Z5Y6 + (0.130427+0i) * Z0Z6 + (0.173887+0i) * Z0Z7 + (0.158846+0i) * Z1Z2 + (4.19845e-10+0i) * X1Z2X3 + (4.19845e-10+0i) * Y1Z2Y3 + (0.135721+0i) * Z1Z3 + (0.159353+0i) * Z1Z4 + (3.54559e-11+0i) * X1Z2Z3Z4X5 + (3.54559e-11+0i) * Y1Z2Z3Z4Y5 + (0.147141+0i) * Z1Z5 + (0.173887+0i) * Z1Z6 + (0.00801359+0i) * X1Z2Z3Z4Z5Z6X7 + (0.00801359+0i) * Y1Z2Z3Z4Z5Z6Y7 + (0.130427+0i) * Z1Z7 + (0.163669+0i) * Z2Z3 + (-0.005669+0i) * X2Z3X4 + (-0.005669+0i) * Y2Z3Y4 + (0.119773+0i) * Z2Z4 + (0.163692+0i) * Z2Z5 + (8.17651e-12+0i) * X2Z3Z4Z5X6 + (8.17651e-12+0i) * Y2Z3Z4Z5Y6 + (0.139625+0i) * Z2Z6 + (0.155968+0i) * Z2Z7 + (0.163692+0i) * Z3Z4 + (-0.005669+0i) * X3Z4X5 + (-0.005669+0i) * Y3Z4Y5 + (0.119773+0i) * Z3Z5 + (0.155968+0i) * Z3Z6 + (8.17651e-12+0i) * X3Z4Z5Z6X7 + (8.17651e-12+0i) * Y3Z4Z5Z6Y7 + (0.139625+0i) * Z3Z7 + (0.173287+0i) * Z4Z5 + (-1.42441e-10+0i) * X4Z5X6 + (-1.42441e-10+0i) * Y4Z5Y6 + (0.133367+0i) * Z4Z6 + (0.16168+0i) * Z4Z7 + (0.16168+0i) * Z5Z6 + (-1.42441e-10+0i) * X5Z6X7 + (-1.42441e-10+0i) * Y5Z6Y7 + (0.133367+0i) * Z5Z7 + (0.176899+0i) * Z6Z7 + (3.2436e-11+0i) * Z0X1Z2X3 + (3.2436e-11+0i) * Z0Y1Z2Y3 + (-1.10661e-11+0i) * Z0X1Z2Z3Z4X5 + (-1.10661e-11+0i) * Z0Y1Z2Z3Z4Y5 + (-0.0405626+0i) * Z0X1Z2Z3Z4Z5Z6X7 + (-0.0405626+0i) * Z0Y1Z2Z3Z4Z5Z6Y7 + (3.2436e-11+0i) * X0X2 + (3.2436e-11+0i) * Y0Y2 + (-1.10661e-11+0i) * X0Z2Z3X4 + (-1.10661e-11+0i) * Y0Z2Z3Y4 + (-0.0405626+0i) * X0Z2Z3Z4Z5X6 + (-0.0405626+0i) * Y0Z2Z3Z4Z5Y6 + (-0.0231244+0i) * X0X1Y2Y3 + (0.0231244+0i) * X0Y1Y2X3 + (0.0231244+0i) * Y0X1X2Y3 + (-0.0231244+0i) * Y0Y1X2X3 + (-0.00729609+0i) * X0X1Y2Z3Z4Y5 + (0.00729609+0i) * X0Y1Y2Z3Z4X5 + (0.00729609+0i) * Y0X1X2Z3Z4Y5 + (-0.00729609+0i) * Y0Y1X2Z3Z4X5 + (-1.01871e-12+0i) * X0X1Y2Z3Z4Z5Z6Y7 + (1.01871e-12+0i) * X0Y1Y2Z3Z4Z5Z6X7 + (1.01871e-12+0i) * Y0X1X2Z3Z4Z5Z6Y7 + (-1.01871e-12+0i) * Y0Y1X2Z3Z4Z5Z6X7 + (-0.00729609+0i) * X0X1X3X4 + (-0.00729609+0i) * X0Y1Y3X4 + (-0.00729609+0i) * Y0X1X3Y4 + (-0.00729609+0i) * Y0Y1Y3Y4 + (-1.01871e-12+0i) * X0X1X3Z4Z5X6 + (-1.01871e-12+0i) * X0Y1Y3Z4Z5X6 + (-1.01871e-12+0i) * Y0X1X3Z4Z5Y6 + (-1.01871e-12+0i) * Y0Y1Y3Z4Z5Y6 + (-0.0122114+0i) * X0X1Y4Y5 + (0.0122114+0i) * X0Y1Y4X5 + (0.0122114+0i) * Y0X1X4Y5 + (-0.0122114+0i) * Y0Y1X4X5 + (-7.23474e-12+0i) * X0X1Y4Z5Z6Y7 + (7.23474e-12+0i) * X0Y1Y4Z5Z6X7 + (7.23474e-12+0i) * Y0X1X4Z5Z6Y7 + (-7.23474e-12+0i) * Y0Y1X4Z5Z6X7 + (-7.23474e-12+0i) * X0X1X5X6 + (-7.23474e-12+0i) * X0Y1Y5X6 + (-7.23474e-12+0i) * Y0X1X5Y6 + (-7.23474e-12+0i) * Y0Y1Y5Y6 + (-0.0434604+0i) * X0X1Y6Y7 + (0.0434604+0i) * X0Y1Y6X7 + (0.0434604+0i) * Y0X1X6Y7 + (-0.0434604+0i) * Y0Y1X6X7 + (0.0337551+0i) * Z0X2Z3X4 + (0.0337551+0i) * Z0Y2Z3Y4 + (6.87846e-12+0i) * Z0X2Z3Z4Z5X6 + (6.87846e-12+0i) * Z0Y2Z3Z4Z5Y6 + (-0.0362638+0i) * X0Z1Z3Z4Z5X6 + (-0.0362638+0i) * Y0Z1Z3Z4Z5Y6 + (0.0108497+0i) * X0Z1X2X4Z5X6 + (-0.00966188+0i) * X0Z1X2Y4Z5Y6 + (0.0205116+0i) * X0Z1Y2Y4Z5X6 + (0.0205116+0i) * Y0Z1X2X4Z5Y6 + (-0.00966188+0i) * Y0Z1Y2X4Z5X6 + (0.0108497+0i) * Y0Z1Y2Y4Z5Y6 + (0.026459+0i) * Z0X3Z4X5 + (0.026459+0i) * Z0Y3Z4Y5 + (5.85975e-12+0i) * Z0X3Z4Z5Z6X7 + (5.85975e-12+0i) * Z0Y3Z4Z5Z6Y7 + (6.58162e-11+0i) * X0Z1X2Z3 + (6.58162e-11+0i) * Y0Z1Y2Z3 + (-1.61176e-12+0i) * X0Z1X2X3Z4X5 + (-1.61176e-12+0i) * X0Z1X2Y3Z4Y5 + (-1.61176e-12+0i) * Y0Z1Y2X3Z4X5 + (-1.61176e-12+0i) * Y0Z1Y2Y3Z4Y5 + (-0.0092937+0i) * X0Z1X2X3Z4Z5Z6X7 + (-0.0092937+0i) * X0Z1X2Y3Z4Z5Z6Y7 + (-0.0092937+0i) * Y0Z1Y2X3Z4Z5Z6X7 + (-0.0092937+0i) * Y0Z1Y2Y3Z4Z5Z6Y7 + (-0.0269701+0i) * X0Z1Z2Z4Z5X6 + (-0.0269701+0i) * Y0Z1Z2Z4Z5Y6 + (5.74004e-12+0i) * X0Z1Z2X3Y4Y5 + (-5.74004e-12+0i) * X0Z1Z2Y3Y4X5 + (-5.74004e-12+0i) * Y0Z1Z2X3X4Y5 + (5.74004e-12+0i) * Y0Z1Z2Y3X4X5 + (0.0137791+0i) * X0Z1Z2X3Y4Z5Z6Y7 + (-0.0137791+0i) * X0Z1Z2Y3Y4Z5Z6X7 + (-0.0137791+0i) * Y0Z1Z2X3X4Z5Z6Y7 + (0.0137791+0i) * Y0Z1Z2Y3X4Z5Z6X7 + (0.0342907+0i) * X0Z1Z2X3X5X6 + (0.0342907+0i) * X0Z1Z2Y3Y5X6 + (0.0342907+0i) * Y0Z1Z2X3X5Y6 + (0.0342907+0i) * Y0Z1Z2Y3Y5Y6 + (9.84733e-12+0i) * X0Z1Z2X3Y6Y7 + (-9.84733e-12+0i) * X0Z1Z2Y3Y6X7 + (-9.84733e-12+0i) * Y0Z1Z2X3X6Y7 + (9.84733e-12+0i) * Y0Z1Z2Y3X6X7 + (1.50734e-11+0i) * Z0X4Z5X6 + (1.50734e-11+0i) * Z0Y4Z5Y6 + (-4.89359e-12+0i) * X0Z1X2Z4 + (-4.89359e-12+0i) * Y0Z1Y2Z4 + (-0.0405248+0i) * X0Z1Z2Z3Z5X6 + (-0.0405248+0i) * Y0Z1Z2Z3Z5Y6 + (7.83868e-12+0i) * Z0X5Z6X7 + (7.83868e-12+0i) * Z0Y5Z6Y7 + (-0.023441+0i) * X0Z1X2X5Z6X7 + (-0.023441+0i) * X0Z1X2Y5Z6Y7 + (-0.023441+0i) * Y0Z1Y2X5Z6X7 + (-0.023441+0i) * Y0Z1Y2Y5Z6Y7 + (-1.31703e-11+0i) * X0Z1Z2Z3X4Z5 + (-1.31703e-11+0i) * Y0Z1Z2Z3Y4Z5 + (-0.010417+0i) * X0Z1Z2Z3X4X5Z6X7 + (-0.010417+0i) * X0Z1Z2Z3X4Y5Z6Y7 + (-0.010417+0i) * Y0Z1Z2Z3Y4X5Z6X7 + (-0.010417+0i) * Y0Z1Z2Z3Y4Y5Z6Y7 + (-0.0301078+0i) * X0Z1Z2Z3Z4X6 + (-0.0301078+0i) * Y0Z1Z2Z3Z4Y6 + (1.0251e-11+0i) * X0Z1Z2Z3Z4X5Y6Y7 + (-1.0251e-11+0i) * X0Z1Z2Z3Z4Y5Y6X7 + (-1.0251e-11+0i) * Y0Z1Z2Z3Z4X5X6Y7 + (1.0251e-11+0i) * Y0Z1Z2Z3Z4Y5X6X7 + (1.9109e-11+0i) * X0Z1X2Z6 + (1.9109e-11+0i) * Y0Z1Y2Z6 + (-1.95416e-11+0i) * X0Z1Z2Z3X4Z6 + (-1.95416e-11+0i) * Y0Z1Z2Z3Y4Z6 + (2.89563e-11+0i) * X0Z1X2Z7 + (2.89563e-11+0i) * Y0Z1Y2Z7 + (-9.2906e-12+0i) * X0Z1Z2Z3X4Z7 + (-9.2906e-12+0i) * Y0Z1Z2Z3Y4Z7 + (-0.0379837+0i) * X0Z1Z2Z3Z4Z5X6Z7 + (-0.0379837+0i) * Y0Z1Z2Z3Z4Z5Y6Z7 + (0.026459+0i) * Z1X2Z3X4 + (0.026459+0i) * Z1Y2Z3Y4 + (5.85975e-12+0i) * Z1X2Z3Z4Z5X6 + (5.85975e-12+0i) * Z1Y2Z3Z4Z5Y6 + (6.58162e-11+0i) * X1X3 + (6.58162e-11+0i) * Y1Y3 + (-0.0269701+0i) * X1Z3Z4Z5Z6X7 + (-0.0269701+0i) * Y1Z3Z4Z5Z6Y7 + (1.61176e-12+0i) * X1X2Y3Y4 + (-1.61176e-12+0i) * X1Y2Y3X4 + (-1.61176e-12+0i) * Y1X2X3Y4 + (1.61176e-12+0i) * Y1Y2X3X4 + (0.0092937+0i) * X1X2Y3Z4Z5Y6 + (-0.0092937+0i) * X1Y2Y3Z4Z5X6 + (-0.0092937+0i) * Y1X2X3Z4Z5Y6 + (0.0092937+0i) * Y1Y2X3Z4Z5X6 + (5.74004e-12+0i) * X1X2X4X5 + (5.74004e-12+0i) * X1Y2Y4X5 + (5.74004e-12+0i) * Y1X2X4Y5 + (5.74004e-12+0i) * Y1Y2Y4Y5 + (0.0342907+0i) * X1X2X4Z5Z6X7 + (0.0342907+0i) * X1Y2Y4Z5Z6X7 + (0.0342907+0i) * Y1X2X4Z5Z6Y7 + (0.0342907+0i) * Y1Y2Y4Z5Z6Y7 + (0.0137791+0i) * X1X2Y5Y6 + (-0.0137791+0i) * X1Y2Y5X6 + (-0.0137791+0i) * Y1X2X5Y6 + (0.0137791+0i) * Y1Y2X5X6 + (9.84733e-12+0i) * X1X2X6X7 + (9.84733e-12+0i) * X1Y2Y6X7 + (9.84733e-12+0i) * Y1X2X6Y7 + (9.84733e-12+0i) * Y1Y2Y6Y7 + (0.0337551+0i) * Z1X3Z4X5 + (0.0337551+0i) * Z1Y3Z4Y5 + (6.87846e-12+0i) * Z1X3Z4Z5Z6X7 + (6.87846e-12+0i) * Z1Y3Z4Z5Z6Y7 + (-0.0362638+0i) * X1Z2Z4Z5Z6X7 + (-0.0362638+0i) * Y1Z2Z4Z5Z6Y7 + (0.0108497+0i) * X1Z2X3X5Z6X7 + (-0.00966188+0i) * X1Z2X3Y5Z6Y7 + (0.0205116+0i) * X1Z2Y3Y5Z6X7 + (0.0205116+0i) * Y1Z2X3X5Z6Y7 + (-0.00966188+0i) * Y1Z2Y3X5Z6X7 + (0.0108497+0i) * Y1Z2Y3Y5Z6Y7 + (7.83868e-12+0i) * Z1X4Z5X6 + (7.83868e-12+0i) * Z1Y4Z5Y6 + (-0.023441+0i) * X1Z2X3X4Z5X6 + (-0.023441+0i) * X1Z2X3Y4Z5Y6 + (-0.023441+0i) * Y1Z2Y3X4Z5X6 + (-0.023441+0i) * Y1Z2Y3Y4Z5Y6 + (-1.31703e-11+0i) * X1Z2Z3X5 + (-1.31703e-11+0i) * Y1Z2Z3Y5 + (-0.0301078+0i) * X1Z2Z3Z5Z6X7 + (-0.0301078+0i) * Y1Z2Z3Z5Z6Y7 + (0.010417+0i) * X1Z2Z3X4Y5Y6 + (-0.010417+0i) * X1Z2Z3Y4Y5X6 + (-0.010417+0i) * Y1Z2Z3X4X5Y6 + (0.010417+0i) * Y1Z2Z3Y4X5X6 + (1.0251e-11+0i) * X1Z2Z3X4X6X7 + (1.0251e-11+0i) * X1Z2Z3Y4Y6X7 + (1.0251e-11+0i) * Y1Z2Z3X4X6Y7 + (1.0251e-11+0i) * Y1Z2Z3Y4Y6Y7 + (1.50734e-11+0i) * Z1X5Z6X7 + (1.50734e-11+0i) * Z1Y5Z6Y7 + (-4.89359e-12+0i) * X1Z2X3Z5 + (-4.89359e-12+0i) * Y1Z2Y3Z5 + (-0.0405248+0i) * X1Z2Z3Z4Z6X7 + (-0.0405248+0i) * Y1Z2Z3Z4Z6Y7 + (2.89563e-11+0i) * X1Z2X3Z6 + (2.89563e-11+0i) * Y1Z2Y3Z6 + (-9.2906e-12+0i) * X1Z2Z3Z4X5Z6 + (-9.2906e-12+0i) * Y1Z2Z3Z4Y5Z6 + (-0.0379837+0i) * X1Z2Z3Z4Z5X7 + (-0.0379837+0i) * Y1Z2Z3Z4Z5Y7 + (1.9109e-11+0i) * X1Z2X3Z7 + (1.9109e-11+0i) * Y1Z2Y3Z7 + (-1.95416e-11+0i) * X1Z2Z3Z4X5Z7 + (-1.95416e-11+0i) * Y1Z2Z3Z4Y5Z7 + (0.0306081+0i) * Z2X3Z4X5 + (0.0306081+0i) * Z2Y3Z4Y5 + (-1.16902e-11+0i) * Z2X3Z4Z5Z6X7 + (-1.16902e-11+0i) * Z2Y3Z4Z5Z6Y7 + (0.0306081+0i) * X2X4 + (0.0306081+0i) * Y2Y4 + (-1.16902e-11+0i) * X2Z4Z5X6 + (-1.16902e-11+0i) * Y2Z4Z5Y6 + (-0.043919+0i) * X2X3Y4Y5 + (0.043919+0i) * X2Y3Y4X5 + (0.043919+0i) * Y2X3X4Y5 + (-0.043919+0i) * Y2Y3X4X5 + (1.04422e-12+0i) * X2X3Y4Z5Z6Y7 + (-1.04422e-12+0i) * X2Y3Y4Z5Z6X7 + (-1.04422e-12+0i) * Y2X3X4Z5Z6Y7 + (1.04422e-12+0i) * Y2Y3X4Z5Z6X7 + (1.04422e-12+0i) * X2X3X5X6 + (1.04422e-12+0i) * X2Y3Y5X6 + (1.04422e-12+0i) * Y2X3X5Y6 + (1.04422e-12+0i) * Y2Y3Y5Y6 + (-0.0163427+0i) * X2X3Y6Y7 + (0.0163427+0i) * X2Y3Y6X7 + (0.0163427+0i) * Y2X3X6Y7 + (-0.0163427+0i) * Y2Y3X6X7 + (-3.6647e-11+0i) * Z2X4Z5X6 + (-3.6647e-11+0i) * Z2Y4Z5Y6 + (-9.11605e-12+0i) * X2Z3Z5X6 + (-9.11605e-12+0i) * Y2Z3Z5Y6 + (-3.56028e-11+0i) * Z2X5Z6X7 + (-3.56028e-11+0i) * Z2Y5Z6Y7 + (0.0360254+0i) * X2Z3X4Z5 + (0.0360254+0i) * Y2Z3Y4Z5 + (-4.91704e-12+0i) * X2Z3X4X5Z6X7 + (-4.91704e-12+0i) * X2Z3X4Y5Z6Y7 + (-4.91704e-12+0i) * Y2Z3Y4X5Z6X7 + (-4.91704e-12+0i) * Y2Z3Y4Y5Z6Y7 + (-4.19901e-12+0i) * X2Z3Z4X6 + (-4.19901e-12+0i) * Y2Z3Z4Y6 + (-0.013094+0i) * X2Z3Z4X5Y6Y7 + (0.013094+0i) * X2Z3Z4Y5Y6X7 + (0.013094+0i) * Y2Z3Z4X5X6Y7 + (-0.013094+0i) * Y2Z3Z4Y5X6X7 + (0.0358977+0i) * X2Z3X4Z6 + (0.0358977+0i) * Y2Z3Y4Z6 + (0.0228038+0i) * X2Z3X4Z7 + (0.0228038+0i) * Y2Z3Y4Z7 + (9.88679e-12+0i) * X2Z3Z4Z5X6Z7 + (9.88679e-12+0i) * Y2Z3Z4Z5Y6Z7 + (-3.56028e-11+0i) * Z3X4Z5X6 + (-3.56028e-11+0i) * Z3Y4Z5Y6 + (0.0360254+0i) * X3X5 + (0.0360254+0i) * Y3Y5 + (-4.19901e-12+0i) * X3Z5Z6X7 + (-4.19901e-12+0i) * Y3Z5Z6Y7 + (4.91704e-12+0i) * X3X4Y5Y6 + (-4.91704e-12+0i) * X3Y4Y5X6 + (-4.91704e-12+0i) * Y3X4X5Y6 + (4.91704e-12+0i) * Y3Y4X5X6 + (-0.013094+0i) * X3X4X6X7 + (-0.013094+0i) * X3Y4Y6X7 + (-0.013094+0i) * Y3X4X6Y7 + (-0.013094+0i) * Y3Y4Y6Y7 + (-3.6647e-11+0i) * Z3X5Z6X7 + (-3.6647e-11+0i) * Z3Y5Z6Y7 + (-9.11605e-12+0i) * X3Z4Z6X7 + (-9.11605e-12+0i) * Y3Z4Z6Y7 + (0.0228038+0i) * X3Z4X5Z6 + (0.0228038+0i) * Y3Z4Y5Z6 + (9.88679e-12+0i) * X3Z4Z5X7 + (9.88679e-12+0i) * Y3Z4Z5Y7 + (0.0358977+0i) * X3Z4X5Z7 + (0.0358977+0i) * Y3Z4Y5Z7 + (1.94341e-11+0i) * Z4X5Z6X7 + (1.94341e-11+0i) * Z4Y5Z6Y7 + (1.94341e-11+0i) * X4X6 + (1.94341e-11+0i) * Y4Y6 + (-0.0283132+0i) * X4X5Y6Y7 + (0.0283132+0i) * X4Y5Y6X7 + (0.0283132+0i) * Y4X5X6Y7 + (-0.0283132+0i) * Y4Y5X6X7 + (1.45914e-11+0i) * X4Z5X6Z7 + (1.45914e-11+0i) * Y4Z5Y6Z7 + (1.45914e-11+0i) * X5X7 + (1.45914e-11+0i) * Y5Y7\n",
      "[Cudaq] Number of terms in the Qubit hamiltonian:  349\n"
     ]
    }
   ],
   "source": [
    "H2O_mol = \"qchem/H2O.xyz\"\n",
    "\n",
    "# Run HF, MP2, casscf and compute the active space spin molecular hamiltonian.\n",
    "# Inspect and the active space from the natural orbitals. Natural orbitals are computed using MP2. \n",
    "# The natural orbitals are used with casscf calaculations.\n",
    "# The casscf  orbitals are used to compute the electron integrals.\n",
    "\n",
    "molecular_data = get_mol_hamiltonian(xyz=H2O_mol, spin=0, charge=0, basis='631g', nele_cas=4, norb_cas=4, \n",
    "                                     MP2=True, natorb=True, casscf=True, integrals_casscf=True, verbose=True)\n",
    "\n",
    "# If do not want to use the natural orbitals to inspect active space, set natorb=False (default).\n",
    "#molecular_data = get_mol_hamiltonian(xyz=H2O_mol, spin=0, charge=0, basis='631g', nele_cas=4, norb_cas=4, \n",
    "#                                    casscf=True, integrals_casscf=True, verbose=True)\n",
    "\n",
    "obi = molecular_data[0]\n",
    "tbi = molecular_data[1]\n",
    "ecore = molecular_data[2]\n",
    "nelectrons = molecular_data[3]\n",
    "norbitals = molecular_data[4]\n",
    "fermionic_hamiltonian = molecular_data[5]\n",
    "\n",
    "print('-------------------------------')\n",
    "print('Molecular data')\n",
    "print('-------------------------------')\n",
    "print('Number of electrons in the active space: ', nelectrons)\n",
    "print('Number of spatial orbitals in the active space: ', norbitals)\n",
    "print('Number of spin molecular orbitals: ', 2 * norbitals)\n",
    "print('Core energy: ', ecore)\n",
    "#print('Fermionic hamiltonian: ', fermionic_hamiltonian)\n",
    "\n",
    "print('-------------------------------')\n",
    "print('Jordan-Wigner transformation')\n",
    "print('-------------------------------')\n",
    "# Compute the qubit hamiltonian.\n",
    "spin_ham = jordan_wigner_fermion(obi, tbi, ecore)\n",
    "print('[Cudaq] Qubit hamiltonian: ', spin_ham)\n",
    "print('[Cudaq] Number of terms in the Qubit hamiltonian: ', spin_ham.term_count)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
