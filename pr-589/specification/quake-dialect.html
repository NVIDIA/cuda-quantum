<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quake Dialect &mdash; NVIDIA CUDA Quantum  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/cudaq_override.css" type="text/css" />
      <link rel="stylesheet" href="../_static/_static/cudaq_override.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Code documentation" href="../api/api.html" />
    <link rel="prev" title="13. Example Programs" href="cudaq/examples.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" > 

          
          
          <a href="../index.html" class="icon icon-home">
            NVIDIA CUDA Quantum
          </a>
              <div class="version">
                amd64-pr-589
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #76b900;
    }

    .wy-side-nav-search a:link, .wy-nav-top a:link {
      color: #fff;
    }
    .wy-side-nav-search a:visited, .wy-nav-top a:visited {
      color: #fff;
    }
    .wy-side-nav-search a:hover, .wy-nav-top a:hover {
      color: #fff;
    }

    .wy-menu-vertical a:link, .wy-menu-vertical a:visited {
      color: #d9d9d9
    }

    .wy-menu-vertical a:active {
      background-color: #76b900
    }

    .wy-side-nav-search>div.version {
      color: rgba(0, 0, 0, 0.3)
    }

    /* override table width restrictions */
    .wy-table-responsive table td, .wy-table-responsive table th {
        white-space: normal;
    }

    .wy-table-responsive {
        margin-bottom: 24px;
        max-width: 100%;
        overflow: visible;
    }
  </style>
  
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">   Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html#docker-image">Docker Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../install.html#install-the-docker-image">Install the Docker Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#use-cuda-quantum-in-a-terminal">Use CUDA Quantum in a Terminal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../install.html#use-cuda-quantum-in-vs-code">Use CUDA Quantum in VS Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#python-wheels">Python wheels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#build-cuda-quantum-from-source">Build CUDA Quantum from Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../install.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using/cudaq.html">   Learn the Basics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using/cudaq/prereqs.html">CUDA Quantum Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/cudaq/compiling.html">Compiling CUDA Quantum Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/cudaq/kernel.html">What is a CUDA Quantum Kernel?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/cudaq/allocating_quantum_memory.html">Allocating Quantum Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/cudaq/runtime_v_compile.html">Runtime Versus Compile-time Kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/cudaq/generic_functions.html">Generic Library Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/cudaq/builder.html">Creating Kernels at Runtime</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/cudaq/variational.html">Variational Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/cudaq/platform.html">Asynchronous Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/cudaq/verbose_out.html">Debugging and Verbose Logging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using/advanced.html">   Advanced Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using/advanced/nvqir_simulator.html">Create a new NVQIR Simulator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../using/advanced/nvqir_simulator.html#circuitsimulator"><code class="code docutils literal notranslate"><span class="pre">CircuitSimulator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/advanced/nvqir_simulator.html#let-s-see-this-in-action">Let’s see this in action</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../using/advanced/cmake_app.html">Downstream CMake Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/advanced/cudaq_ir.html">Working with CUDA Quantum IR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../using/advanced/mlir_pass.html">Create an MLIR Pass for CUDA Quantum</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using/examples.html">   Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using/cpp.html">   CUDA Quantum in C++</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../using/cpp.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/cpp.html#computing-expectation-values">Computing Expectation Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/cpp.html#multi-control-synthesis">Multi-control Synthesis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/cpp.html#simulations-with-cuquantum">Simulations with cuQuantum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/cpp.html#using-quantum-hardware-providers">Using Quantum Hardware Providers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../using/python.html">   CUDA Quantum in Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../using/python.html#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/python.html#bernstein-vazirani">Bernstein-Vazirani</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/python.html#variational-quantum-eigensolver">Variational Quantum Eigensolver</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/python.html#quantum-approximate-optimization-algorithm">Quantum Approximate Optimization Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/python.html#using-quantum-hardware-providers">Using Quantum Hardware Providers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using/simulators.html">   Simulator Backends</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using/simulators.html#state-vector-simulators">State Vector Simulators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../using/simulators.html#cuquantum-single-gpu">cuQuantum single-GPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/simulators.html#cuquantum-multi-node-multi-gpu">cuQuantum multi-node multi-GPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/simulators.html#openmp-cpu-only">OpenMP CPU-only</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../using/simulators.html#tensor-network-simulators">Tensor Network Simulators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../using/simulators.html#id1">cuQuantum multi-node multi-GPU</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../using/hardware.html">   Hardware Backends</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../using/hardware.html#quantinuum">Quantinuum</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../using/hardware.html#setting-credentials">Setting Credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/hardware.html#submission-from-c">Submission from C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/hardware.html#submission-from-python">Submission from Python</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../using/hardware.html#ionq">IonQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../using/hardware.html#id1">Setting Credentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/hardware.html#id2">Submission from C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using/hardware.html#id3">Submission from Python</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">   Specifications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cudaq.html">   Language Specification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cudaq/machine_model.html">1. Machine Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/namespace.html">2. Namespace</a></li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/types.html">3. Quantum Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cudaq/types.html#cudaq-qudit-levels">3.1. <code class="code docutils literal notranslate"><span class="pre">cudaq::qudit&lt;Levels&gt;</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/types.html#cudaq-qubit">3.2. <code class="code docutils literal notranslate"><span class="pre">cudaq::qubit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/types.html#quantum-containers">3.3. Quantum Containers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/operators.html">4. Quantum Operators</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cudaq/operators.html#cudaq-spin-op">4.1. <code class="code docutils literal notranslate"><span class="pre">cudaq::spin_op</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/operations.html">5. Quantum Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cudaq/operations.html#operations-on-cudaq-qubit">5.1. Operations on <code class="code docutils literal notranslate"><span class="pre">cudaq::qubit</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/kernels.html">6. Quantum Kernels</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cudaq/kernels.html#kernel-composability">6.1. Kernel Composability</a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/kernels.html#allowed-kernel-classical-function-invocations">6.2. Allowed Kernel Classical Function Invocations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/synthesis.html">7. Sub-circuit Synthesis</a></li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/control_flow.html">8. Control Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/dynamic_kernels.html">9. Just-in-Time Kernel Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/patterns.html">10. Quantum Patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cudaq/patterns.html#compute-action-uncompute">10.1. Compute-Action-Uncompute</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/platform.html">11. Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/algorithmic_primitives.html">12. Algorithmic Primitives</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cudaq/algorithmic_primitives.html#cudaq-sample">12.1. <code class="code docutils literal notranslate"><span class="pre">cudaq::sample</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/algorithmic_primitives.html#cudaq-observe">12.2. <code class="code docutils literal notranslate"><span class="pre">cudaq::observe</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/algorithmic_primitives.html#cudaq-optimizer">12.3. <code class="code docutils literal notranslate"><span class="pre">cudaq::optimizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/algorithmic_primitives.html#cudaq-gradient">12.4. <code class="code docutils literal notranslate"><span class="pre">cudaq::gradient</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="cudaq/examples.html">13. Example Programs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="cudaq/examples.html#hello-world-simple-bell-state">13.1. Hello World - Simple Bell State</a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/examples.html#ghz-state-preparation-and-sampling">13.2. GHZ State Preparation and Sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/examples.html#quantum-phase-estimation">13.3. Quantum Phase Estimation</a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/examples.html#deuteron-binding-energy-parameter-sweep">13.4. Deuteron Binding Energy Parameter Sweep</a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/examples.html#grover-s-algorithm">13.5. Grover’s Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="cudaq/examples.html#iterative-phase-estimation">13.6. Iterative Phase Estimation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">   Quake Specification</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general-introduction">General Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#motivation">Motivation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quake-types">Quake Types</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/api.html">   API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/languages/cpp_api.html">C++ API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#operators">Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#quantum">Quantum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#common">Common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#noise-modeling">Noise Modeling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#kernel-builder">Kernel Builder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#algorithms">Algorithms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#platform">Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/cpp_api.html#namespaces">Namespaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/languages/python_api.html">Python API</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#cudaq.initialize_cudaq"><code class="docutils literal notranslate"><span class="pre">initialize_cudaq()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#cudaq.num_available_gpus"><code class="docutils literal notranslate"><span class="pre">num_available_gpus()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#cudaq.set_random_seed"><code class="docutils literal notranslate"><span class="pre">set_random_seed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.initialize"><code class="docutils literal notranslate"><span class="pre">initialize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.rank"><code class="docutils literal notranslate"><span class="pre">rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.num_ranks"><code class="docutils literal notranslate"><span class="pre">num_ranks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.all_gather"><code class="docutils literal notranslate"><span class="pre">all_gather()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.is_initialized"><code class="docutils literal notranslate"><span class="pre">is_initialized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#cudaq.mpi.finalize"><code class="docutils literal notranslate"><span class="pre">finalize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#program-construction">Program Construction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.from_state"><code class="docutils literal notranslate"><span class="pre">from_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.make_kernel"><code class="docutils literal notranslate"><span class="pre">make_kernel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.Kernel"><code class="docutils literal notranslate"><span class="pre">Kernel</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#kernel-execution">Kernel Execution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.sample"><code class="docutils literal notranslate"><span class="pre">sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.sample_async"><code class="docutils literal notranslate"><span class="pre">sample_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.observe"><code class="docutils literal notranslate"><span class="pre">observe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.observe_async"><code class="docutils literal notranslate"><span class="pre">observe_async()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.vqe"><code class="docutils literal notranslate"><span class="pre">vqe()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#backend-configuration">Backend Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.has_target"><code class="docutils literal notranslate"><span class="pre">has_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.get_target"><code class="docutils literal notranslate"><span class="pre">get_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.get_targets"><code class="docutils literal notranslate"><span class="pre">get_targets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.set_target"><code class="docutils literal notranslate"><span class="pre">set_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.reset_target"><code class="docutils literal notranslate"><span class="pre">reset_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.set_noise"><code class="docutils literal notranslate"><span class="pre">set_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.unset_noise"><code class="docutils literal notranslate"><span class="pre">unset_noise()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/languages/python_api.html#data-types">Data Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.QuakeValue"><code class="docutils literal notranslate"><span class="pre">QuakeValue</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.qubit"><code class="docutils literal notranslate"><span class="pre">qubit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.qreg"><code class="docutils literal notranslate"><span class="pre">qreg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.ComplexMatrix"><code class="docutils literal notranslate"><span class="pre">ComplexMatrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.SpinOperator"><code class="docutils literal notranslate"><span class="pre">SpinOperator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.spin.i"><code class="docutils literal notranslate"><span class="pre">spin.i()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.spin.x"><code class="docutils literal notranslate"><span class="pre">spin.x()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.spin.y"><code class="docutils literal notranslate"><span class="pre">spin.y()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.spin.z"><code class="docutils literal notranslate"><span class="pre">spin.z()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.SampleResult"><code class="docutils literal notranslate"><span class="pre">SampleResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.AsyncSampleResult"><code class="docutils literal notranslate"><span class="pre">AsyncSampleResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.ObserveResult"><code class="docutils literal notranslate"><span class="pre">ObserveResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.AsyncObserveResult"><code class="docutils literal notranslate"><span class="pre">AsyncObserveResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#cudaq.OptimizationResult"><code class="docutils literal notranslate"><span class="pre">OptimizationResult</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#optimizers">Optimizers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#gradients">Gradients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/languages/python_api.html#noisy-simulation">Noisy Simulation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../versions.html">   Other Versions</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NVIDIA CUDA Quantum</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Specifications</a></li>
      <li class="breadcrumb-item active">Quake Dialect</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/specification/quake-dialect.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="quake-dialect">
<h1>Quake Dialect<a class="headerlink" href="#quake-dialect" title="Permalink to this heading">¶</a></h1>
<section id="general-introduction">
<h2>General Introduction<a class="headerlink" href="#general-introduction" title="Permalink to this heading">¶</a></h2>
<p>The quantum circuit model is the most widely used model of quantum
computation.  It provides a convenient tool for formulating quantum
algorithms and an architecture for the physical construction of quantum
computers.</p>
<p>A <em>quantum circuit</em> represents a computation as a sequence of quantum
operators applied to quantum data.  In our case, the quantum data is a set
of quantum bits, or qubits for short.  Physically, a qubit is an object with
only two distinguishable states, i.e., it is a two-state quantum mechanical
system such as a spin-1/2 particle.</p>
<p>Conceptually, a <em>quantum operator</em> is an effect that might modify the state
of a subset of qubits. Most often, this effect is unitary evolution—in
this case, we say that the operator is a <em>unitary</em>.  The number of target
qubits an operator acts upon is an intrinsic property.</p>
<p>A <em>quantum instruction</em> is the embodiment of a quantum operator when applied
to a specific subset of qubits.  The number of qubits must be equal to (or
greater than) the number of target qubits intrinsic to the operator.  If
greater, the extra qubits are considered controls.</p>
</section>
<section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this heading">¶</a></h2>
<p>The main motivation behind Quake’s value model is to directly expose
quantum and classical data dependencies for optimization purposes,
i.e., to represent the dataflow in quantum computations.  In contrast
to Quake’s memory model, which uses memory semantics (quantum
operators act as side-effects on qubit references), the value model
uses value semantics, that is quantum operators consume and produce
values. These values are not truly SSA values, however, as operations
still have side-effects on the value itself and the value cannot be
copied.</p>
<p>Let’s see an example to clarify the distinction between the models.  Take the
following Quake implementation of some toy quantum computation:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">.</span><span class="n">func</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="o">%</span><span class="n">veq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="o">!</span><span class="n">quake</span><span class="p">.</span><span class="n">veq</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Boilerplate to extract each qubit from the vector</span>
<span class="w">    </span><span class="o">%</span><span class="n">c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arith</span><span class="p">.</span><span class="n">constant</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">index</span>
<span class="w">    </span><span class="o">%</span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arith</span><span class="p">.</span><span class="n">constant</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">index</span>
<span class="w">    </span><span class="o">%</span><span class="n">q0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quake</span><span class="p">.</span><span class="n">extract_ref</span><span class="w"> </span><span class="o">%</span><span class="n">veq</span><span class="p">[</span><span class="o">%</span><span class="n">c0</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">quake</span><span class="p">.</span><span class="n">veq</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">!</span><span class="n">quake</span><span class="p">.</span><span class="n">ref</span>
<span class="w">    </span><span class="o">%</span><span class="n">q1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quake</span><span class="p">.</span><span class="n">extract_ref</span><span class="w"> </span><span class="o">%</span><span class="n">veq</span><span class="p">[</span><span class="o">%</span><span class="n">c1</span><span class="p">]</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">quake</span><span class="p">.</span><span class="n">veq</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">!</span><span class="n">quake</span><span class="p">.</span><span class="n">ref</span>

<span class="w">    </span><span class="c1">// We apply some operators to those extracted qubits</span>
<span class="w">    </span><span class="c1">// ... bunch of operators using %q0 and %q1 ...</span>
<span class="w">    </span><span class="n">quake</span><span class="p">.</span><span class="n">h</span><span class="w"> </span><span class="o">%</span><span class="n">q0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">quake</span><span class="p">.</span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">()</span>

<span class="w">    </span><span class="c1">// We decide to measure the vector</span>
<span class="w">    </span><span class="o">%</span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quake</span><span class="p">.</span><span class="n">mz</span><span class="w"> </span><span class="o">%</span><span class="n">veq</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">quake</span><span class="p">.</span><span class="n">veq</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">cc</span><span class="p">.</span><span class="n">stdvec</span><span class="o">&lt;</span><span class="n">i1</span><span class="o">&gt;</span>

<span class="w">    </span><span class="c1">// And then apply another Hadamard to %q0</span>
<span class="w">    </span><span class="n">quake</span><span class="p">.</span><span class="n">h</span><span class="w"> </span><span class="o">%</span><span class="n">q0</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">quake</span><span class="p">.</span><span class="n">ref</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now imagine we want to optimize this code by removing pair of adjacent
adjoint operators, e.g., if we have a pair Hadamard operations next to each
other on the same qubit—visually:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>    ┌───┐ ┌───┐         ┌───┐
   ─┤ H ├─┤ H ├─  =  ───┤ I ├───  =  ─────────────
    └───┘ └───┘         └───┘
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">I</span></code> is the identity operator. Now note that a naive implemention of
this optimization for Quake would optimize away both <code class="docutils literal notranslate"><span class="pre">quake.h</span></code> operators
being applied to <code class="docutils literal notranslate"><span class="pre">%q0</span></code>.  Such an implementation would have missed the fact
that a measurement is being applied to the vector, <code class="docutils literal notranslate"><span class="pre">%veq</span></code>, which contains
<code class="docutils literal notranslate"><span class="pre">%q0</span></code>.</p>
<p>Of course it is possible to correctly implement this optimization for Quake.
However such an implementation would be quite error-prone and require
complex analyses.  For this reason, Quake has overloaded gates.</p>
<p>In the value model operators consume values and return new values:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>  %q0_1 = quake.op %q0_0 : (!quake.wire) -&gt; !quake.wire
</pre></div>
</div>
<p>We can visualize the difference between memory and value representation as:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>            Memory                                   Value

        ┌──┐ ┌──┐     ┌──┐                  ┌──┐ %q0_1 ┌──┐     ┌──┐
   %q0 ─┤  ├─┤  ├─···─┤  ├─ %q0  vs  %q0_0 ─┤  ├───────┤  ├─···─┤  ├─ %q0_Z
        └──┘ └──┘     └──┘                  └──┘       └──┘     └──┘
</pre></div>
</div>
<p>If we look at the implementation again, we notice that the problem
with the naive optimization happens because the Hadamard operators are
implicitly connected by the same value <code class="docutils literal notranslate"><span class="pre">%q0</span></code>. In value form, all the gates
are explicitly connected by distinct values, which eliminates the need
to do further analysis via implicit side-effects.
The following is the implementation in value form.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>func.func @foo(%array : !quake.qvec&lt;2&gt;) {
    // Boilerplate to extract each qubit
    %c0 = arith.constant 0 : index
    %c1 = arith.constant 1 : index
    %r0 = quake.extract_ref %array[%c0] : (!quake.qvec&lt;2&gt;, index) -&gt; !quake.qref
    %r1 = quake.extract_ref %array[%c1] : (!quake.qvec&lt;2&gt;, index) -&gt; !quake.qref

    // Unwrap the quantum references to expose the wires.
    %q0 = quake.unwrap %r0 : (!quake.qref) -&gt; !quake.wire
    %q1 = quake.unwrap %r1 : (!quake.qref) -&gt; !quake.wire

    // Misc. operators applied
    %q0_M = quake.h %q0_L : (!quake.wire) -&gt; !quake.wire

    // Re-wrap the wire to its original source
    quake.wrap %q0_M to %r0 : !quake.wire, !quake.qref
    quake.wrap %q1_X to %r1 : !quake.wire, !quake.qref

    // Measure the entire vector of quantum references
    %result = quake.mz %array : (!quake.qvec&lt;2&gt;) -&gt; !cc.stdvec&lt;i1&gt;

    // Unwrap the wire for qubit 0 again
    %q0_P = quake.unwrap %r0 : (!quake.qref) -&gt; !quake.wire
    ...
    %q0_Z = quake.h %q0_Y : (!quake.wire) -&gt; !quake.wire
    // Re-wrap the wire back to the original reference
    quake.wrap %q0_Z to %r0 : !quake.wire, !quake.qref
    return
}
</pre></div>
</div>
<p>In this code we can more straightforwardly see that the Hadamard
operators cannot cancel each other.  One way of reasoning about this
is as follows: In value form we need to follow a chain of values to
know the qubit operators are being applied to, in this example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Mmeory                          Value
    %q0         [%q0_0, %q0_1 ... %q0_L, %q0_M; %q0_P ... %q0_Y, %q0_Z]
</pre></div>
</div>
<p>We know that one Hadamard is applied to <code class="docutils literal notranslate"><span class="pre">%q0_L</span></code> and generates <code class="docutils literal notranslate"><span class="pre">%q0_M</span></code>, and
the other is applied <code class="docutils literal notranslate"><span class="pre">%q0_Y</span></code> and generates <code class="docutils literal notranslate"><span class="pre">%q0_Z</span></code>.  Hence, there is no
connection between them—which means they cannot cancel each other out.</p>
</section>
<section id="quake-types">
<h2>Quake Types<a class="headerlink" href="#quake-types" title="Permalink to this heading">¶</a></h2>
<p>In value form, we use the <code class="docutils literal notranslate"><span class="pre">!quake.wire</span></code> type to represent an
intermediate “state” of a single qubit in time.  One can view the
values of this type as line segments in a quantum circuit diagram.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cudaq/examples.html" class="btn btn-neutral float-left" title="13. Example Programs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../api/api.html" class="btn btn-neutral float-right" title="Code documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, NVIDIA Corporation &amp; Affiliates.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>  

  <style>
  a:link, a:visited {
    color: #76b900;
  }

  a:hover {
    color: #8c0;
  }

  .rst-content dl:not(.docutils) dt {
    background: rgba(118, 185, 0, 0.1);
    color: rgba(59,93,0,1);
    border-top: solid 3px rgba(59,93,0,1);
  }
  </style>
  

</body>
</html>